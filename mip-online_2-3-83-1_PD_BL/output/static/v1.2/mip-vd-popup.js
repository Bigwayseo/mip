define("extensions/mip-vd-popup/0.1/tab",["require"],function(){function t(t,a,o,n,p){var s=0;a>t||(s=t>=n-a?o.parent().offset().width:o.offset().left-o.parent().offset().left-o.width()),i||(p?e(o.parent().parent().scrollLeft(),s,o.parent().parent()):o.parent().parent().scrollLeft(s))}function e(t,e,a){var o=(e-t)/8;i=setInterval(function(){var t=a.scrollLeft();o>0&&t>=e||0==o?(o=0,clearInterval(i)):0>o&&e>=t&&(o=0,clearInterval(i)),a.scrollLeft(t+o)},30),setTimeout(function(){clearInterval(i),a.scrollLeft(e),i=null},270)}var i,a=function(){},o=function(){var t=this,e=$(t.panel);this.toggle=e.find("."+t.toggleClass),this.view=e.find("."+t.viewClass),this.wrapper=e.find("."+t.navWrapperClass),this.navs=this.wrapper.find("."+t.navClass),this.conts=e.find("."+t.contClass),this.sum=this.navs.length,this.tabScroll=void 0,l.call(this),this.allowScroll&&this.view.length&&p.call(this),this.toggleMore&&this.allowScroll&&this.view.length&&s.call(this)},n=function(t){var e=this;return t.children().eq(0).wrap('<div class="mip-vd-tabs-scroll-touch"></div>'),t.children().eq(1).hasClass(e.toggleClass)&&t.find("."+e.navWrapperClass).append('<div class="mip-vd-tabs-nav-toggle-holder"></div>'),t},p=function(){var e=this;if(e.tabScroll=n.call(e,e.view),e.current>0&&e.current<e.sum){var i=Math.min(e.current+1,e.sum-1);e.navs.eq(i).length&&e.navs.eq(i).position().left>e.view.width()-29&&t(i,1,e.navs.eq(e.current),e.navs.length,!1)}"function"==typeof e.onTabScrollEnd&&e.tabScroll.on("scrollEnd",function(){this.customFlag&&this.customFlag.autoScroll||e.onTabScrollEnd.call(e,this)})},s=function(){function t(){o.empty(),a.hide(),i.toggle.css({"-webkit-transform":"scaleY(1)",transform:"scaleY(1)"}),i.toggleState=0}function e(){o.html(i.navs.clone()),a.append(o),i.view.after(a.show()),i.toggle.css({"-webkit-transform":"scaleY(1)",transform:"scaleY(-1)"}),i.toggleState=1}var i=this,a=$('<div class="'+i.layerClass+'"><p>'+i.toggleLabel+"</p></div>"),o=$('<ul class="'+i.layerUlClass+'"></ul>');i.toggleState=0,o.on("click","."+i.navClass,function(){var e=$(this);i.navs.eq(e.attr("data-tid")).trigger("click"),t()}),i.toggle.on("click",function(){0==i.toggleState?e():t()})},l=function(){var e=this;$.each(e.navs,function(i,o){var n=$(o);n.hasClass(e.currentClass)&&(e.current=i),n.addClass(e.logClass),n.attr("data-tid",i),n.on("click",function(){var i=parseInt($(this).attr("data-tid"));i!==e.current&&(e.last=e.current,e.current=i,e.hideTab(e.last),e.showTab(e.current),e.onResetChange==a?(e.hideContent(e.last),e.showContent(e.current),e.onChange.call(e,e.current,e.conts[e.current])):e.onResetChange.call(e,e.current),e.tabScroll&&t(e.current+1,1,n,e.navs.length,!0))})}),$.each(e.conts,function(t){t==e.current?(e.showTab(t),e.showContent(t)):(e.hideTab(t),e.hideContent(t))})},r=function(t,e){e=e||{},this.panel=t,this.current=e.current||0,this.currentClass=e.currentClass||"c-tabs-nav-selected",this.navWrapperClass=e.navWrapperClass||"c-tabs-nav",this.navClass=e.navClass||"c-tabs-nav-li",this.contClass=e.contClass||"c-tabs-content",this.viewClass=e.viewClass||"c-tabs-nav-view",this.toggleClass=e.toggleClass||"c-tabs-nav-toggle",this.layerClass=e.layerClass||"c-tabs-nav-layer",this.layerUlClass=e.layerUlClass||"c-tabs-nav-layer-ul",this.allowScroll=e.allowScroll||!1,this.toggleMore=e.toggleMore||!1,this.toggleLabel=e.toggleLabel||"请选择",this.logClass=e.logClass||"WA_LOG_TAB",this.scrollSize=e.scrollSize||"-40",this.navs=[],this.seps=[],this.conts=[],this.sum=0,this.last=null,this.onChange=e.onChange||a,this.onResetChange=e.onResetChange||a,this.onTabScrollEnd=e.onTabScrollEnd,t&&o.call(this,e)};return $.extend(r.prototype,{showContent:function(t){var e=this.conts[t];e&&$(this.conts[t]).show()},hideContent:function(t){var e=this.conts[t];e&&$(e).hide()},showTab:function(t){var e=this,i=e.navs;e.seps,$(i[t]).addClass(e.currentClass)},hideTab:function(t){var e=this,i=e.navs;e.seps,$(i[t]).removeClass(e.currentClass)}}),r}),define("extensions/mip-vd-popup/0.1/popup",["require"],function(){var t=function(t){var e=this;e.options=$.extend({title:"",content:"",fullView:!1,duration:400,customClassName:"",onOpen:function(){},onClose:function(){}},t),e._init()};return t.prototype={constructor:t,version:"0.0.1",_init:function(){var t=this;t._preparePopupWrapper(),t.popup()},_preparePopupWrapper:function(){var t=this,e=$(".mip-vd-popup-wrapper");e.length?(t.$popupFrame=e,t.$popupFrame.empty()):(t.$popupFrame=$('<div class="mip-vd-popup-wrapper"></div>'),$(document.body).append(t.$popupFrame))},_stopScroll:function(){var t=this;t.$popupFrame.on("touchmove",function(t){t.preventDefault()})},_bindEvent:function(){var t=this;t.$popupFrame.on("click",".mip-vd-popup-mask,.mip-vd-popup-remove",function(){t.closePopup()})},_randerContent:function(){var t=this;if(t.$popupMask=$('<div class="mip-vd-popup-mask"></div>'),t.$popupModal=$('<div class="mip-vd-popup-modal"></div>'),t.$popupContent=$('<div class="mip-vd-popup-content"></div>'),t.$popupHead=$('<div class="mip-vd-popup-head"></div>'),t.options.title){var e=$('<div class="mip-vd-popup-title"></div>');e.append(t.options.title),t.$popupHead.append(e)}var i=$('<div class="mip-vd-popup-remove"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqBAMAAAA37dRoAAAAElBMVEUAAABmZmZmZmZmZmZmZmZmZmYlNPltAAAABXRSTlMAnAFiY7dPC10AAACQSURBVCjPfdPdCYAgFIZhsQkKuq8m6KYRGiDK/Vep5MALL2IQfepD/nHSMCU/656Oa1Fnnu80l8m0XN8rnH+XhYMJhwJD+UIJpiQEEeDMOA2GwaI0oWDRwEGFt0qNx0qNS1BhUff6D93ZvLLuLrzj3un4JE2NfUPOYN+8EoIAEcVAwaahghq3q+VsVNbTrsIXTkQ1/j8utO4AAAAASUVORK5CYII="></div>');t.$popupHead.append(i),t.$popupContent.append(t.options.content),t.$popupModal.append(t.$popupHead).append(t.$popupContent).addClass(t.options.customClassName),t.$popupFrame.append(t.$popupModal).append(t.$popupMask)},popup:function(){var t=this,e=$(window).height();t._randerContent(),t._bindEvent(),t.$popupMask.show().animate({opacity:1},"fast","ease"),t.$popupModal.show();var i=t.$popupModal.height();(t.options.fullView||i>e)&&t.$popupModal.height("100%"),t.$popupModal.animate({"-webkit-transform":"translate3d(0, 0, 0)",transform:"translate3d(0, 0, 0)"},t.options.duration,"ease",function(){$(this).css({"-webkit-transform":"none",transform:"none"}),t.options.onOpen()})},closePopup:function(){var t=this;t.$popupModal.animate({"-webkit-transform":"translate3d(0, 100%, 0)",transform:"translate3d(0, 100%, 0)"},t.options.duration,"ease",function(){$(this).css({"-webkit-transform":"none",transform:"none"}).hide(),t.options.onClose(),t._destroy()}),t.$popupMask.animate({opacity:0},"fast","ease",function(){$(this).hide()})},_destroy:function(){var t=this;t.$popupFrame.off("click",".mip-vd-popup-mask,.mip-vd-popup-remove"),t.$popupFrame.empty()}},t}),define("extensions/mip-vd-popup/0.1/mip-vd-popup",["require","zepto","customElement","extensions/mip-vd-popup/0.1/tab","extensions/mip-vd-popup/0.1/popup"],function(t){function e(){var t=this.element;if(!t.isRender){t.isRender=!0;var e=n(t),p=t.getAttribute("type"),s=t.getAttribute("link-tpl"),l=null,r=null;switch(p){case"episode":l=i.call(this,s),r=e,o.call(this,l);break;default:r=e.children().eq(0),l=e.children().eq(1).addClass("mip-vd-popup-dom")}a.call(this,r,l)}}function i(t){for(var e=n(this.element),i=parseInt(e.attr("page-size"),10)||f,a=parseInt(e.attr("current"),10)||1,o=parseInt(e.attr("total"),10)||1,p=Math.ceil(o/i),s=Math.floor((a-1)/i),l=[],h=0;p>h;h++){var w=i*h+1,x=Math.min(o,i*(h+1));l.push({from:w,to:x,text:""+w+(x>w?" - "+x:"")})}var C=n('<div class="'+r+'"></div>');if(C.append(l.map(function(e,i){for(var o='<div class="'+d+' mip-vd-tabs-episode-content" '+(i===s?"":'style="display:none;" ')+" >",n=e.from;n<=e.to;n++){var p=n===a?"mip-vd-tabs-episode-item-selected":"",l=t?' href="'+t.replace(g,n)+'"':"";o=o+'<span class="mip-vd-tabs-episode-item '+p+'" '+l+">"+n+"</span>"}return o+="</div>"}).join("")).append(),p>1){var k="",$=4;p>$&&(k='<div class="'+u+'">'),k+='<ul class="'+m+" "+b+' mip-vd-tabs-episode-bottom-nav">',k+=l.map(function(t,e){var i=e===s?v:"";return'<li class="'+c+" "+i+'">'+t.text+"</li>"}).join(""),k+="</ul>",p>$&&(k+="</div>"),C.append(k)}return C}function a(t,e){var i=this.element,a=n(i),o=parseInt(a.attr("page-size"),10)||f,p=parseInt(a.attr("current"),10)||1,r=parseInt(a.attr("total"),10)||1,b=Math.ceil(r/o);n(t).on("click",function(){new l({title:i.getAttribute("title")||"",content:e,fullView:!1,customClassName:"mip-vd-popup-custom-modal",onOpen:function(){new s(e,{allowScroll:b>4,current:Math.floor((p-1)/o)||0,currentClass:v,navWrapperClass:m,viewClass:u,contClass:d,navClass:c,logClass:"mip-vd-tabs-log",toggleClass:h})}})})}function o(t){var e=n(this.element),i=this.element.getAttribute("head-title");t.delegate(".mip-vd-tabs-episode-item","click",function(t){t.preventDefault();var a=n(this).attr("href");if(a){var o=n(this).text()||"",p={event:"loadiframe",data:{url:a,title:i||o,click:e.data("click")}};window.parent!==window?window.parent.postMessage(p,"*"):location.href=a}})}var n=t("zepto"),p=t("customElement").create(),s=t("extensions/mip-vd-popup/0.1/tab"),l=t("extensions/mip-vd-popup/0.1/popup"),r="mip-vd-tabs",d="mip-vd-tabs-content",v="mip-vd-tabs-nav-selected",c="mip-vd-tabs-nav-li",m="mip-vd-tabs-nav",u="mip-vd-tabs-nav-view",h="mip-vd-tabs-nav-toggle",b="mip-vd-tabs-nav-bottom",f=50,g=/\{\{\w}}/g;return p.prototype.init=function(){this.build=e},p}),require(["extensions/mip-vd-popup/0.1/mip-vd-popup"],function(t){MIP.css.mipVdPopup=".mip-vd-popup-wrapper{z-index:900}.mip-vd-popup-mask{display:none;position:fixed;left:0;top:0;opacity:0;width:100%;height:100%;background:rgba(0,0,0,.4);z-index:901}.mip-vd-popup-modal{display:none;position:fixed;left:0;bottom:0;width:100%;background-color:#fff;z-index:902;margin:0;overflow:hidden;-webkit-transform:translate3d(0,100%,0);transform:translate3d(0,100%,0);overflow-y:scroll}.mip-vd-popup-head{text-align:left;padding:0 16px;height:43px;line-height:43px;border-bottom:1px solid #eee}.mip-vd-popup-title{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.mip-vd-popup-remove{position:absolute;padding:15px 16px;right:0;top:0;line-height:14px;z-index:901}.mip-vd-popup-remove img{width:14px;height:14px}.mip-vd-popup-content{text-align:center;margin:0}.mip-vd-popup-dom{display:none}.mip-vd-popup-content .mip-vd-popup-dom{display:block}.mip-vd-popup-modal .mip-vd-tabs-nav-view{height:38px}.mip-vd-tabs{position:relative}.mip-vd-tabs-nav{display:-webkit-box;display:-webkit-flex;height:44px;font-size:14px;white-space:nowrap;background-color:#fff;-webkit-align-content:flex-start;-webkit-align-items:stretch;-webkit-box-align:stretch;-webkit-box-direction:normal;-webkit-box-lines:single;-webkit-box-orient:horizontal;-webkit-box-pack:justify;-webkit-flex-direction:row;-webkit-flex-wrap:nowrap;-webkit-justify-content:space-between;padding:0 16px}.mip-vd-tabs-nav *{-webkit-box-sizing:border-box;box-sizing:border-box}.mip-vd-tabs-nav-li{display:block;overflow:hidden;width:16.66666667%;height:44px;padding:0 14px 0 15px;line-height:44px;text-align:center;white-space:nowrap;text-decoration:none;text-overflow:ellipsis;list-style:none;color:#333;-webkit-box-flex:1;-webkit-flex:1 1 auto}.mip-vd-tabs-nav .mip-vd-tabs-nav-selected{border-bottom:1px solid #38f;color:#38f}.mip-vd-tabs-nav-bottom{border-top:1px solid #eee;background:#f8f8f8}.mip-vd-tabs-nav-bottom .mip-vd-tabs-nav-li{color:#666}.mip-vd-tabs-nav-bottom .mip-vd-tabs-nav-icon{display:none}.mip-vd-tabs-nav-bottom .mip-vd-tabs-nav-li.mip-vd-tabs-nav-selected{position:relative;top:-1px;height:38px;border:1px solid #f1f1f1;border-color:#fff #f1f1f1 #38f;line-height:38px;color:#333;background-color:#fff}.mip-vd-tabs-nav-bottom .mip-vd-tabs-nav-selected:first-child{margin-left:-1px}.mip-vd-tabs-nav-bottom .mip-vd-tabs-nav-selected .mip-vd-tabs-nav-icon{display:inline-block}.mip-vd-tabs-nav-view{position:relative;overflow:hidden;height:44px;text-align:left;background-color:#fff}.mip-vd-tabs-nav-view .mip-vd-tabs-nav{display:inline-block;position:relative}.mip-vd-tabs-nav-view .mip-vd-tabs-nav .mip-vd-tabs-nav-li{display:inline-block;vertical-align:middle;width:auto;padding:0 15px}.mip-vd-tabs-nav-view .mip-vd-tabs-nav.mip-vd-tabs-nav-bottom{background-color:#f8f8f8;position:relative;display:inline-block;vertical-align:middle}.mip-vd-tabs-nav-layer{position:absolute;z-index:8;top:0;width:100%;border-bottom:1px solid #e7e7e7;background-color:#fff}.mip-vd-tabs-nav-layer p{height:44px;padding:0 16px;border-bottom:1px solid #eee;line-height:44px;text-align:left;color:#333}.mip-vd-tabs-nav-layer-ul .mip-vd-tabs-nav-li{display:inline-block;width:16.66666667%;padding:0}.mip-vd-tabs-nav-layer-ul .mip-vd-tabs-nav-selected{color:#38f}.mip-vd-tabs .mip-vd-tabs-nav-toggle{position:absolute;z-index:9;top:0;right:0;display:block;width:42px;height:26px;margin:9px 0;border-left:1px solid #ccc;text-align:center;background-color:#fff}.mip-vd-tabs .mip-vd-tabs-nav-toggle img{position:absolute;top:50%;left:50%;display:inline-block;width:10px;height:6px;margin:-3px 0 0 -5px}.mip-vd-tabs .mip-vd-tabs-nav-toggle-holder{display:inline-block;width:29px;height:1px;visibility:hidden}.mip-vd-tabs-scroll-touch{position:relative;overflow-x:auto;-webkit-overflow-scrolling:touch;padding-bottom:30px;margin-top:-30px;-webkit-transform:translateY(30px);transform:translateY(30px);width:1px;min-width:100%}.mip-vd-tabs-episode-content{padding:15px 16px;text-align:left}.mip-vd-tabs-episode-item{display:inline-block;width:20%;height:40px;line-height:40px;text-align:center}.mip-vd-tabs-episode-item-selected{color:#38f}.mip-vd-tabs-episode-bottom-nav{padding:0;height:38px}.mip-vd-tabs-episode-bottom-nav .mip-vd-tabs-nav-li{height:38px;line-height:38px}.mip-vd-tabs-nav-view>.mip-vd-tabs-scroll-touch>.mip-vd-tabs-episode-bottom-nav.mip-vd-tabs-nav>.mip-vd-tabs-nav-li{display:inline-block}.mip-vd-tabs-episode-bottom-nav.mip-vd-tabs-nav .mip-vd-tabs-nav-li{display:block}.mip-vd-tabs-row-tile{width:100%;position:relative;overflow:hidden}",MIP.registerMipElement("mip-vd-popup",t,MIP.css.mipVdPopup)});