define("mip-ck-course-detail/js/catalog",["require","zepto","./util","./mediator","./tpl-data"],function(t){function i(t,i){var e=g.domain+"/wap/mip/course/catalog";m.ajax({url:e,data:{courseId:d,sid:u,cid:t},dataType:"jsonp",success:function(t,e,n){t=t||{};var s=parseInt(t.code,10)||0;if(s>0)l.find(".d-list-directory .cur").removeClass("cur"),i.addClass("cur"),b.trigger("change-video-src",{data:t.data}),x.scrollTop(0),o();else alert(t.data||"获取播放信息失败，请重试！")}})}function e(){var t=a.height(),i=l.height();if(i>t)h.show().on("click",function(t){a.animate({height:i},function(){h.hide()})});else a.height(i)}function n(){var t=l.find(".cur"),i=l.find(".video_list"),e=t.get(0)===i.last().get(0);return e}function o(){if(2===f){var t=n();m("#trial-next")[t?"hide":"show"]()}}function s(){var t=n();if(1===f)m("#play-end")[t?"hide":"show"]()}function r(){a=m("#list_box"),l=a.find(".details-list"),c=a.parent(),h=c.find(".ico-unfold"),p=v.get("courseInfo"),d=p.courseid,u=p.sid,f=p.type,e(),b.on("toggle-end-pop",function(t){s()}),b.on("trial-next",function(t){var i=l.find(".cur"),e=l.find(".video_list"),n=e.indexOf(i[0]),o=e.eq(n+1);if(o.length)o.find(".preview").trigger("click")}),o(),l.on("click",".video_list .preview",function(t){t.preventDefault();var e=m(this),n=e.parent("li"),o=parseInt(n.attr("cid"),10)||0;if(0!==o)i(o,n)})}var a,l,c,h,p,d,u,f,m=t("zepto"),g=t("./util"),b=t("./mediator"),v=t("./tpl-data"),x=m(window);return r});