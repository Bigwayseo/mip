define("mip-bsml-carousel/iscroll/iscroll",["require","exports","module"],function(e,t,i){!function(e,t,o){function n(e,i){this.wrapper="string"==typeof e?t.querySelector(e):e,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,snapThreshold:.334,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0};for(var o in i)this.options[o]=i[o];if(this.translateZ=this.options.HWCompositing&&l.hasPerspective?" translateZ(0)":"",this.options.useTransition=l.hasTransition&&this.options.useTransition,this.options.useTransform=l.hasTransform&&this.options.useTransform,this.options.eventPassthrough=this.options.eventPassthrough===!0?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"==this.options.eventPassthrough?!1:this.options.scrollY,this.options.scrollX="horizontal"==this.options.eventPassthrough?!1:this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?l.ease[this.options.bounceEasing]||l.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,this.options.tap===!0)this.options.tap="tap";if("scale"==this.options.shrinkScrollbars)this.options.useTransition=!1;this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function a(e,i,o){var n=t.createElement("div"),a=t.createElement("div");if(o===!0)n.style.cssText="position:absolute;z-index:9999",a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px";if(a.className="iScrollIndicator","h"==e){if(o===!0)n.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",a.style.height="100%";n.className="iScrollHorizontalScrollbar"}else{if(o===!0)n.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",a.style.width="100%";n.className="iScrollVerticalScrollbar"}if(n.style.cssText+=";overflow:hidden",!i)n.style.pointerEvents="none";return n.appendChild(a),n}function s(i,o){this.wrapper="string"==typeof o.el?t.querySelector(o.el):o.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=i,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0};for(var n in o)this.options[n]=o[n];if(this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive){if(!this.options.disableTouch)l.addEvent(this.indicator,"touchstart",this),l.addEvent(e,"touchend",this);if(!this.options.disablePointer)l.addEvent(this.indicator,l.prefixPointerEvent("pointerdown"),this),l.addEvent(e,l.prefixPointerEvent("pointerup"),this);if(!this.options.disableMouse)l.addEvent(this.indicator,"mousedown",this),l.addEvent(e,"mouseup",this)}if(this.options.fade)this.wrapperStyle[l.style.transform]=this.scroller.translateZ,this.wrapperStyle[l.style.transitionDuration]=l.isBadAndroid?"0.001s":"0ms",this.wrapperStyle.opacity="0"}var r=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){e.setTimeout(t,1e3/60)},l=function(){function i(e){if(s===!1)return!1;if(""===s)return e;else return s+e.charAt(0).toUpperCase()+e.substr(1)}var n={},a=t.createElement("div").style,s=function(){for(var e,t=["t","webkitT","MozT","msT","OT"],i=0,o=t.length;i<o;i++)if(e=t[i]+"ransform",e in a)return t[i].substr(0,t[i].length-1);return!1}();n.getTime=Date.now||function(){return(new Date).getTime()},n.extend=function(e,t){for(var i in t)e[i]=t[i]},n.addEvent=function(e,t,i,o){e.addEventListener(t,i,!!o)},n.removeEvent=function(e,t,i,o){e.removeEventListener(t,i,!!o)},n.prefixPointerEvent=function(t){return e.MSPointerEvent?"MSPointer"+t.charAt(9).toUpperCase()+t.substr(10):t},n.momentum=function(e,t,i,n,a,s){var r,l,d=e-t,c=o.abs(d)/i;if(s=void 0===s?6e-4:s,r=e+c*c/(2*s)*(d<0?-1:1),l=c/s,r<n)r=a?n-a/2.5*(c/8):n,d=o.abs(r-e),l=d/c;else if(r>0)r=a?a/2.5*(c/8):0,d=o.abs(e)+r,l=d/c;return{destination:o.round(r),duration:l}};var r=i("transform");return n.extend(n,{hasTransform:r!==!1,hasPerspective:i("perspective")in a,hasTouch:"ontouchstart"in e,hasPointer:e.PointerEvent||e.MSPointerEvent,hasTransition:i("transition")in a}),n.isBadAndroid=/Android /.test(e.navigator.appVersion)&&!/Chrome\/\d/.test(e.navigator.appVersion),n.extend(n.style={},{transform:r,transitionTimingFunction:i("transitionTimingFunction"),transitionDuration:i("transitionDuration"),transitionDelay:i("transitionDelay"),transformOrigin:i("transformOrigin")}),n.hasClass=function(e,t){var i=new RegExp("(^|\\s)"+t+"(\\s|$)");return i.test(e.className)},n.addClass=function(e,t){if(!n.hasClass(e,t)){var i=e.className.split(" ");i.push(t),e.className=i.join(" ")}},n.removeClass=function(e,t){if(n.hasClass(e,t)){var i=new RegExp("(^|\\s)"+t+"(\\s|$)","g");e.className=e.className.replace(i," ")}},n.offset=function(e){for(var t=-e.offsetLeft,i=-e.offsetTop;e=e.offsetParent;)t-=e.offsetLeft,i-=e.offsetTop;return{left:t,top:i}},n.preventDefaultException=function(e,t){for(var i in t)if(t[i].test(e[i]))return!0;return!1},n.extend(n.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),n.extend(n.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(e){return e*(2-e)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(e){return o.sqrt(1- --e*e)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(e){var t=4;return(e-=1)*e*((t+1)*e+t)+1}},bounce:{style:"",fn:function(e){if((e/=1)<1/2.75)return 7.5625*e*e;else if(e<2/2.75)return 7.5625*(e-=1.5/2.75)*e+.75;else if(e<2.5/2.75)return 7.5625*(e-=2.25/2.75)*e+.9375;else return 7.5625*(e-=2.625/2.75)*e+.984375}},elastic:{style:"",fn:function(e){var t=.22,i=.4;if(0===e)return 0;if(1==e)return 1;else return i*o.pow(2,-10*e)*o.sin((e-t/4)*(2*o.PI)/t)+1}}}),n.tap=function(e,i){var o=t.createEvent("Event");o.initEvent(i,!0,!0),o.pageX=e.pageX,o.pageY=e.pageY,e.target.dispatchEvent(o)},n.click=function(e){var i,o=e.target;if(!/(SELECT|INPUT|TEXTAREA)/i.test(o.tagName))i=t.createEvent("MouseEvents"),i.initMouseEvent("click",!0,!0,e.view,1,o.screenX,o.screenY,o.clientX,o.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),i._constructed=!0,o.dispatchEvent(i)},n}();if(n.prototype={version:"5.1.3",_init:function(){if(this._initEvents(),this.options.scrollbars||this.options.indicators)this._initIndicators();if(this.options.mouseWheel)this._initWheel();if(this.options.snap)this._initSnap();if(this.options.keyBindings)this._initKeys()},destroy:function(){this._initEvents(!0),this._execEvent("destroy")},_transitionEnd:function(e){if(e.target==this.scroller&&this.isInTransition)if(this._transitionTime(),!this.resetPosition(this.options.bounceTime))this.isInTransition=!1,this._execEvent("scrollEnd")},_start:function(e){if(1!=l.eventType[e.type])if(0!==e.button)return;if(this.enabled&&(!this.initiated||l.eventType[e.type]===this.initiated)){if(this.options.preventDefault&&!l.isBadAndroid&&!l.preventDefaultException(e.target,this.options.preventDefaultException))e.preventDefault();var t,i=e.touches?e.touches[0]:e;if(this.initiated=l.eventType[e.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=l.getTime(),this.options.useTransition&&this.isInTransition)this.isInTransition=!1,t=this.getComputedPosition(),this._translate(o.round(t.x),o.round(t.y)),this._execEvent("scrollEnd");else if(!this.options.useTransition&&this.isAnimating)this.isAnimating=!1,this._execEvent("scrollEnd");this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=i.pageX,this.pointY=i.pageY,this._execEvent("beforeScrollStart")}},_move:function(e){if(this.enabled&&l.eventType[e.type]===this.initiated){if(this.options.preventDefault)e.preventDefault();var t,i,n,a,s=e.touches?e.touches[0]:e,r=s.pageX-this.pointX,d=s.pageY-this.pointY,c=l.getTime();if(this.pointX=s.pageX,this.pointY=s.pageY,this.distX+=r,this.distY+=d,n=o.abs(this.distX),a=o.abs(this.distY),!(c-this.endTime>300&&n<10&&a<10)){if(!this.directionLocked&&!this.options.freeScroll)if(n>a+this.options.directionLockThreshold)this.directionLocked="h";else if(a>=n+this.options.directionLockThreshold)this.directionLocked="v";else this.directionLocked="n";if("h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)e.preventDefault();else if("horizontal"==this.options.eventPassthrough)return void(this.initiated=!1);d=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)e.preventDefault();else if("vertical"==this.options.eventPassthrough)return void(this.initiated=!1);r=0}if(r=this.hasHorizontalScroll?r:0,d=this.hasVerticalScroll?d:0,t=this.x+r,i=this.y+d,t>0||t<this.maxScrollX)t=this.options.bounce?this.x+r/3:t>0?0:this.maxScrollX;if(i>0||i<this.maxScrollY)i=this.options.bounce?this.y+d/3:i>0?0:this.maxScrollY;if(this.directionX=r>0?-1:r<0?1:0,this.directionY=d>0?-1:d<0?1:0,!this.moved)this._execEvent("scrollStart");if(this.moved=!0,this._translate(t,i),c-this.startTime>300)this.startTime=c,this.startX=this.x,this.startY=this.y}}},_end:function(e){if(this.enabled&&l.eventType[e.type]===this.initiated){if(this.options.preventDefault&&!l.preventDefaultException(e.target,this.options.preventDefaultException))e.preventDefault();var t,i,n=(e.changedTouches?e.changedTouches[0]:e,l.getTime()-this.startTime),a=o.round(this.x),s=o.round(this.y),r=o.abs(a-this.startX),d=o.abs(s-this.startY),c=0,p="";if(this.isInTransition=0,this.initiated=0,this.endTime=l.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(a,s),!this.moved){if(this.options.tap)l.tap(e,this.options.tap);if(this.options.click)l.click(e);return void this._execEvent("scrollCancel")}if(this._events.flick&&n<200&&r<100&&d<100)return void this._execEvent("flick");if(this.options.momentum&&n<300)t=this.hasHorizontalScroll?l.momentum(this.x,this.startX,n,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:a,duration:0},i=this.hasVerticalScroll?l.momentum(this.y,this.startY,n,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:s,duration:0},a=t.destination,s=i.destination,c=o.max(t.duration,i.duration),this.isInTransition=1;if(this.options.snap){var u=this._nearestSnap(a,s);this.currentPage=u,c=this.options.snapSpeed||o.max(o.max(o.min(o.abs(a-u.x),1e3),o.min(o.abs(s-u.y),1e3)),300),a=u.x,s=u.y,this.directionX=0,this.directionY=0,p=this.options.bounceEasing}if(a!=this.x||s!=this.y){if(a>0||a<this.maxScrollX||s>0||s<this.maxScrollY)p=l.ease.quadratic;return void this.scrollTo(a,s,c,p)}this._execEvent("scrollEnd")}}},_resize:function(){var e=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){e.refresh()},this.options.resizePolling)},resetPosition:function(e){var t=this.x,i=this.y;if(e=e||0,!this.hasHorizontalScroll||this.x>0)t=0;else if(this.x<this.maxScrollX)t=this.maxScrollX;if(!this.hasVerticalScroll||this.y>0)i=0;else if(this.y<this.maxScrollY)i=this.maxScrollY;if(t==this.x&&i==this.y)return!1;else return this.scrollTo(t,i,e,this.options.bounceEasing),!0},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight;if(this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,!this.hasHorizontalScroll)this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth;if(!this.hasVerticalScroll)this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight;this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=l.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(e,t){if(!this._events[e])this._events[e]=[];this._events[e].push(t)},off:function(e,t){if(this._events[e]){var i=this._events[e].indexOf(t);if(i>-1)this._events[e].splice(i,1)}},_execEvent:function(e){if(this._events[e]){var t=0,i=this._events[e].length;if(i)for(;t<i;t++)this._events[e][t].apply(this,[].slice.call(arguments,1))}},scrollBy:function(e,t,i,o){e=this.x+e,t=this.y+t,i=i||0,this.scrollTo(e,t,i,o)},scrollTo:function(e,t,i,o){if(o=o||l.ease.circular,this.isInTransition=this.options.useTransition&&i>0,!i||this.options.useTransition&&o.style)this._transitionTimingFunction(o.style),this._transitionTime(i),this._translate(e,t);else this._animate(e,t,i,o.fn)},scrollToElement:function(e,t,i,n,a){if(e=e.nodeType?e:this.scroller.querySelector(e)){var s=l.offset(e);if(s.left-=this.wrapperOffset.left,s.top-=this.wrapperOffset.top,i===!0)i=o.round(e.offsetWidth/2-this.wrapper.offsetWidth/2);if(n===!0)n=o.round(e.offsetHeight/2-this.wrapper.offsetHeight/2);s.left-=i||0,s.top-=n||0,s.left=s.left>0?0:s.left<this.maxScrollX?this.maxScrollX:s.left,s.top=s.top>0?0:s.top<this.maxScrollY?this.maxScrollY:s.top,t=void 0===t||null===t||"auto"===t?o.max(o.abs(this.x-s.left),o.abs(this.y-s.top)):t,this.scrollTo(s.left,s.top,t,a)}},_transitionTime:function(e){if(e=e||0,this.scrollerStyle[l.style.transitionDuration]=e+"ms",!e&&l.isBadAndroid)this.scrollerStyle[l.style.transitionDuration]="0.001s";if(this.indicators)for(var t=this.indicators.length;t--;)this.indicators[t].transitionTime(e)},_transitionTimingFunction:function(e){if(this.scrollerStyle[l.style.transitionTimingFunction]=e,this.indicators)for(var t=this.indicators.length;t--;)this.indicators[t].transitionTimingFunction(e)},_translate:function(e,t){if(this.options.useTransform)this.scrollerStyle[l.style.transform]="translate("+e+"px,"+t+"px)"+this.translateZ;else e=o.round(e),t=o.round(t),this.scrollerStyle.left=e+"px",this.scrollerStyle.top=t+"px";if(this.x=e,this.y=t,this.indicators)for(var i=this.indicators.length;i--;)this.indicators[i].updatePosition()},_initEvents:function(t){var i=t?l.removeEvent:l.addEvent,o=this.options.bindToWrapper?this.wrapper:e;if(i(e,"orientationchange",this),i(e,"resize",this),this.options.click)i(this.wrapper,"click",this,!0);if(!this.options.disableMouse)i(this.wrapper,"mousedown",this),i(o,"mousemove",this),i(o,"mousecancel",this),i(o,"mouseup",this);if(l.hasPointer&&!this.options.disablePointer)i(this.wrapper,l.prefixPointerEvent("pointerdown"),this),i(o,l.prefixPointerEvent("pointermove"),this),i(o,l.prefixPointerEvent("pointercancel"),this),i(o,l.prefixPointerEvent("pointerup"),this);if(l.hasTouch&&!this.options.disableTouch)i(this.wrapper,"touchstart",this),i(o,"touchmove",this),i(o,"touchcancel",this),i(o,"touchend",this);i(this.scroller,"transitionend",this),i(this.scroller,"webkitTransitionEnd",this),i(this.scroller,"oTransitionEnd",this),i(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var t,i,o=e.getComputedStyle(this.scroller,null);if(this.options.useTransform)o=o[l.style.transform].split(")")[0].split(", "),t=+(o[12]||o[4]),i=+(o[13]||o[5]);else t=+o.left.replace(/[^-\d.]/g,""),i=+o.top.replace(/[^-\d.]/g,"");return{x:t,y:i}},_initIndicators:function(){function e(e){for(var t=r.indicators.length;t--;)e.call(r.indicators[t])}var t,i=this.options.interactiveScrollbars,o="string"!=typeof this.options.scrollbars,n=[],r=this;if(this.indicators=[],this.options.scrollbars){if(this.options.scrollY)t={el:a("v",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:o,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(t.el),n.push(t);if(this.options.scrollX)t={el:a("h",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:o,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(t.el),n.push(t)}if(this.options.indicators)n=n.concat(this.options.indicators);for(var l=n.length;l--;)this.indicators.push(new s(this,n[l]));if(this.options.fadeScrollbars)this.on("scrollEnd",function(){e(function(){this.fade()})}),this.on("scrollCancel",function(){e(function(){this.fade()})}),this.on("scrollStart",function(){e(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){e(function(){this.fade(1,!0)})});this.on("refresh",function(){e(function(){this.refresh()})}),this.on("destroy",function(){e(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){l.addEvent(this.wrapper,"wheel",this),l.addEvent(this.wrapper,"mousewheel",this),l.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){l.removeEvent(this.wrapper,"wheel",this),l.removeEvent(this.wrapper,"mousewheel",this),l.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(e){if(this.enabled){e.preventDefault(),e.stopPropagation();var t,i,n,a,s=this;if(void 0===this.wheelTimeout)s._execEvent("scrollStart");if(clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){s._execEvent("scrollEnd"),s.wheelTimeout=void 0},400),"deltaX"in e)if(1===e.deltaMode)t=-e.deltaX*this.options.mouseWheelSpeed,i=-e.deltaY*this.options.mouseWheelSpeed;else t=-e.deltaX,i=-e.deltaY;else if("wheelDeltaX"in e)t=e.wheelDeltaX/120*this.options.mouseWheelSpeed,i=e.wheelDeltaY/120*this.options.mouseWheelSpeed;else if("wheelDelta"in e)t=i=e.wheelDelta/120*this.options.mouseWheelSpeed;else if("detail"in e)t=i=-e.detail/3*this.options.mouseWheelSpeed;else return;if(t*=this.options.invertWheelDirection,i*=this.options.invertWheelDirection,!this.hasVerticalScroll)t=i,i=0;if(this.options.snap){if(n=this.currentPage.pageX,a=this.currentPage.pageY,t>0)n--;else if(t<0)n++;if(i>0)a--;else if(i<0)a++;return void this.goToPage(n,a)}if(n=this.x+o.round(this.hasHorizontalScroll?t:0),a=this.y+o.round(this.hasVerticalScroll?i:0),n>0)n=0;else if(n<this.maxScrollX)n=this.maxScrollX;if(a>0)a=0;else if(a<this.maxScrollY)a=this.maxScrollY;this.scrollTo(n,a,0)}},_initSnap:function(){if(this.currentPage={},"string"==typeof this.options.snap)this.options.snap=this.scroller.querySelectorAll(this.options.snap);this.on("refresh",function(){var e,t,i,n,a,s,r=0,l=0,d=0,c=this.options.snapStepX||this.wrapperWidth,p=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(this.options.snap===!0)for(i=o.round(c/2),n=o.round(p/2);d>-this.scrollerWidth;){for(this.pages[r]=[],e=0,a=0;a>-this.scrollerHeight;)this.pages[r][e]={x:o.max(d,this.maxScrollX),y:o.max(a,this.maxScrollY),width:c,height:p,cx:d-i,cy:a-n},a-=p,e++;d-=c,r++}else for(s=this.options.snap,e=s.length,t=-1;r<e;r++){if(0===r||s[r].offsetLeft<=s[r-1].offsetLeft)l=0,t++;if(!this.pages[l])this.pages[l]=[];if(d=o.max(-s[r].offsetLeft,this.maxScrollX),a=o.max(-s[r].offsetTop,this.maxScrollY),i=d-o.round(s[r].offsetWidth/2),n=a-o.round(s[r].offsetHeight/2),this.pages[l][t]={x:d,y:a,width:s[r].offsetWidth,height:s[r].offsetHeight,cx:i,cy:n},d>this.maxScrollX)l++}if(this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1===0)this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold;else this.snapThresholdX=o.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=o.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold)}}),this.on("flick",function(){var e=this.options.snapSpeed||o.max(o.max(o.min(o.abs(this.x-this.startX),1e3),o.min(o.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,e)})},_nearestSnap:function(e,t){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var i=0,n=this.pages.length,a=0;if(o.abs(e-this.absStartX)<this.snapThresholdX&&o.abs(t-this.absStartY)<this.snapThresholdY)return this.currentPage;if(e>0)e=0;else if(e<this.maxScrollX)e=this.maxScrollX;if(t>0)t=0;else if(t<this.maxScrollY)t=this.maxScrollY;for(;i<n;i++)if(e>=this.pages[i][0].cx){e=this.pages[i][0].x;break}for(n=this.pages[i].length;a<n;a++)if(t>=this.pages[0][a].cy){t=this.pages[0][a].y;break}if(i==this.currentPage.pageX){if(i+=this.directionX,i<0)i=0;else if(i>=this.pages.length)i=this.pages.length-1;e=this.pages[i][0].x}if(a==this.currentPage.pageY){if(a+=this.directionY,a<0)a=0;else if(a>=this.pages[0].length)a=this.pages[0].length-1;t=this.pages[0][a].y}return{x:e,y:t,pageX:i,pageY:a}},goToPage:function(e,t,i,n){if(n=n||this.options.bounceEasing,e>=this.pages.length)e=this.pages.length-1;else if(e<0)e=0;if(t>=this.pages[e].length)t=this.pages[e].length-1;else if(t<0)t=0;var a=this.pages[e][t].x,s=this.pages[e][t].y;i=void 0===i?this.options.snapSpeed||o.max(o.max(o.min(o.abs(a-this.x),1e3),o.min(o.abs(s-this.y),1e3)),300):i,this.currentPage={x:a,y:s,pageX:e,pageY:t},this.scrollTo(a,s,i,n)},next:function(e,t){var i=this.currentPage.pageX,o=this.currentPage.pageY;if(i++,i>=this.pages.length&&this.hasVerticalScroll)i=0,o++;this.goToPage(i,o,e,t)},prev:function(e,t){var i=this.currentPage.pageX,o=this.currentPage.pageY;if(i--,i<0&&this.hasVerticalScroll)i=0,o--;this.goToPage(i,o,e,t)},_initKeys:function(t){var i,o={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings){for(i in this.options.keyBindings)if("string"==typeof this.options.keyBindings[i])this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0)}else this.options.keyBindings={};for(i in o)this.options.keyBindings[i]=this.options.keyBindings[i]||o[i];l.addEvent(e,"keydown",this),this.on("destroy",function(){l.removeEvent(e,"keydown",this)})},_key:function(e){if(this.enabled){var t,i=this.options.snap,n=i?this.currentPage.pageX:this.x,a=i?this.currentPage.pageY:this.y,s=l.getTime(),r=this.keyTime||0,d=.25;if(this.options.useTransition&&this.isInTransition)t=this.getComputedPosition(),this._translate(o.round(t.x),o.round(t.y)),this.isInTransition=!1;switch(this.keyAcceleration=s-r<200?o.min(this.keyAcceleration+d,50):0,e.keyCode){case this.options.keyBindings.pageUp:if(this.hasHorizontalScroll&&!this.hasVerticalScroll)n+=i?1:this.wrapperWidth;else a+=i?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:if(this.hasHorizontalScroll&&!this.hasVerticalScroll)n-=i?1:this.wrapperWidth;else a-=i?1:this.wrapperHeight;break;case this.options.keyBindings.end:n=i?this.pages.length-1:this.maxScrollX,a=i?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:n=0,a=0;break;case this.options.keyBindings.left:n+=i?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:a+=i?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:n-=i?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:a-=i?1:5+this.keyAcceleration>>0;break;default:return}if(i)return void this.goToPage(n,a);if(n>0)n=0,this.keyAcceleration=0;else if(n<this.maxScrollX)n=this.maxScrollX,this.keyAcceleration=0;if(a>0)a=0,this.keyAcceleration=0;else if(a<this.maxScrollY)a=this.maxScrollY,this.keyAcceleration=0;this.scrollTo(n,a,0),this.keyTime=s}},_animate:function(e,t,i,o){function n(){var u,h,m,f=l.getTime();if(!(f>=p)){if(f=(f-c)/i,m=o(f),u=(e-s)*m+s,h=(t-d)*m+d,a._translate(u,h),a.isAnimating)r(n)}else if(a.isAnimating=!1,a._translate(e,t),!a.resetPosition(a.options.bounceTime))a._execEvent("scrollEnd")}var a=this,s=this.x,d=this.y,c=l.getTime(),p=c+i;this.isAnimating=!0,n()},handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(e);break;case"keydown":this._key(e);break;case"click":if(!e._constructed)e.preventDefault(),e.stopPropagation()}}},s.prototype={handleEvent:function(e){switch(e.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(e);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(e);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(e)}},destroy:function(){if(this.options.interactive)l.removeEvent(this.indicator,"touchstart",this),l.removeEvent(this.indicator,l.prefixPointerEvent("pointerdown"),this),l.removeEvent(this.indicator,"mousedown",this),l.removeEvent(e,"touchmove",this),l.removeEvent(e,l.prefixPointerEvent("pointermove"),this),l.removeEvent(e,"mousemove",this),l.removeEvent(e,"touchend",this),l.removeEvent(e,l.prefixPointerEvent("pointerup"),this),l.removeEvent(e,"mouseup",this);if(this.options.defaultScrollbars)this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(t){var i=t.touches?t.touches[0]:t;if(t.preventDefault(),t.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=i.pageX,this.lastPointY=i.pageY,this.startTime=l.getTime(),!this.options.disableTouch)l.addEvent(e,"touchmove",this);if(!this.options.disablePointer)l.addEvent(e,l.prefixPointerEvent("pointermove"),this);if(!this.options.disableMouse)l.addEvent(e,"mousemove",this);this.scroller._execEvent("beforeScrollStart")},_move:function(e){var t,i,o,n,a=e.touches?e.touches[0]:e;l.getTime();if(!this.moved)this.scroller._execEvent("scrollStart");this.moved=!0,t=a.pageX-this.lastPointX,this.lastPointX=a.pageX,i=a.pageY-this.lastPointY,this.lastPointY=a.pageY,o=this.x+t,n=this.y+i,this._pos(o,n),e.preventDefault(),e.stopPropagation()},_end:function(t){if(this.initiated){if(this.initiated=!1,t.preventDefault(),t.stopPropagation(),l.removeEvent(e,"touchmove",this),l.removeEvent(e,l.prefixPointerEvent("pointermove"),this),l.removeEvent(e,"mousemove",this),this.scroller.options.snap){var i=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),n=this.options.snapSpeed||o.max(o.max(o.min(o.abs(this.scroller.x-i.x),1e3),o.min(o.abs(this.scroller.y-i.y),1e3)),300);if(this.scroller.x!=i.x||this.scroller.y!=i.y)this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=i,this.scroller.scrollTo(i.x,i.y,n,this.scroller.options.bounceEasing)}if(this.moved)this.scroller._execEvent("scrollEnd")}},transitionTime:function(e){if(e=e||0,this.indicatorStyle[l.style.transitionDuration]=e+"ms",!e&&l.isBadAndroid)this.indicatorStyle[l.style.transitionDuration]="0.001s"},transitionTimingFunction:function(e){this.indicatorStyle[l.style.transitionTimingFunction]=e},refresh:function(){if(this.transitionTime(),this.options.listenX&&!this.options.listenY)this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none";else if(this.options.listenY&&!this.options.listenX)this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none";else this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none";if(this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll){if(l.addClass(this.wrapper,"iScrollBothScrollbars"),l.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle)if(this.options.listenX)this.wrapper.style.right="8px";else this.wrapper.style.bottom="8px"}else if(l.removeClass(this.wrapper,"iScrollBothScrollbars"),l.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle)if(this.options.listenX)this.wrapper.style.right="2px";else this.wrapper.style.bottom="2px";this.wrapper.offsetHeight;if(this.options.listenX){if(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize)this.indicatorWidth=o.max(o.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px";else this.indicatorWidth=this.indicator.clientWidth;if(this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"==this.options.shrink)this.minBoundaryX=-this.indicatorWidth+8,this.maxBoundaryX=this.wrapperWidth-8;else this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX;this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX}if(this.options.listenY){if(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize)this.indicatorHeight=o.max(o.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px";else this.indicatorHeight=this.indicator.clientHeight;if(this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"==this.options.shrink)this.minBoundaryY=-this.indicatorHeight+8,this.maxBoundaryY=this.wrapperHeight-8;else this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY;this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY}this.updatePosition()},updatePosition:function(){var e=this.options.listenX&&o.round(this.sizeRatioX*this.scroller.x)||0,t=this.options.listenY&&o.round(this.sizeRatioY*this.scroller.y)||0;if(!this.options.ignoreBoundaries){if(e<this.minBoundaryX){if("scale"==this.options.shrink)this.width=o.max(this.indicatorWidth+e,8),this.indicatorStyle.width=this.width+"px";e=this.minBoundaryX}else if(e>this.maxBoundaryX)if("scale"==this.options.shrink)this.width=o.max(this.indicatorWidth-(e-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",e=this.maxPosX+this.indicatorWidth-this.width;else e=this.maxBoundaryX;else if("scale"==this.options.shrink&&this.width!=this.indicatorWidth)this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px";if(t<this.minBoundaryY){if("scale"==this.options.shrink)this.height=o.max(this.indicatorHeight+3*t,8),this.indicatorStyle.height=this.height+"px";t=this.minBoundaryY}else if(t>this.maxBoundaryY)if("scale"==this.options.shrink)this.height=o.max(this.indicatorHeight-3*(t-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",t=this.maxPosY+this.indicatorHeight-this.height;else t=this.maxBoundaryY;else if("scale"==this.options.shrink&&this.height!=this.indicatorHeight)this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px"}if(this.x=e,this.y=t,this.scroller.options.useTransform)this.indicatorStyle[l.style.transform]="translate("+e+"px,"+t+"px)"+this.scroller.translateZ;else this.indicatorStyle.left=e+"px",this.indicatorStyle.top=t+"px"},_pos:function(e,t){if(e<0)e=0;else if(e>this.maxPosX)e=this.maxPosX;if(t<0)t=0;else if(t>this.maxPosY)t=this.maxPosY;
e=this.options.listenX?o.round(e/this.sizeRatioX):this.scroller.x,t=this.options.listenY?o.round(t/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(e,t)},fade:function(e,t){if(!t||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var i=e?250:500,o=e?0:300;e=e?"1":"0",this.wrapperStyle[l.style.transitionDuration]=i+"ms",this.fadeTimeout=setTimeout(function(e){this.wrapperStyle.opacity=e,this.visible=+e}.bind(this,e),o)}}},n.utils=l,"undefined"!=typeof i&&i.exports)i.exports=n;else e.IScroll=n}(window,document,Math)});