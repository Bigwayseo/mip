define("mip-iask-business/mip-iask-business",["require","zepto","customElement"],function(t){function e(t,e){var n=new Array(0),r=new Array(0),o=new Array(0);if(i.each(e,function(i){try{var s=e[i],a=s.qTags,l=s.mainTags,c=s.startTime,u=s.endTime,d="不限",f="不限";if(s.province)d=s.province;if(s.nprovince)f=s.nprovince;if("79"===t.qCid||"147"===t.bCid)if(_(t.nowTime,c,u)&&k(t.province,d,f)&&T(t.qTags,a,t.mainTags,l))for(var p=s.adPosition,h=p.split(","),m=0;m<h.length;m++){if("1"===h[m])n.push(s);if("2"===h[m])r.push(s);if("3"===h[m])o.push(s)}}catch(t){}}),n.length>0){var s=x(0,n.length-1);h(n[s],t)}if(r.length>0){var a=x(0,r.length-1);h(r[a],t)}if(o.length>0){var l=x(0,o.length-1);h(o[l],t)}}var i=t("zepto"),n=t("customElement").create(),r=function(t){var e="http://ipip.iask.cn/iplookup/search?format=json&callback=?";try{i.getJSON(e,function(e){t(e)})}catch(t){}},o=function(t,e){try{r(function(n){if(t.indexOf(n.province)===-1)i(e).remove()})}catch(t){}},s=function(t,e,n){try{if(i(t).length<=0)if("show"===n)i(e).show();else i(e).hide()}catch(t){}},a=function(){i(".mip_as_haoping_div").remove(),i(".mip_as_qita_div").remove(),i(".mip_as_lswt_div").remove(),i(".mip_as_xgzs_div").remove(),i(".mip_as_jrjd").remove(),i(".mip_dl_jrjd").remove(),i(".mip_as_tbtj").remove(),i(".mip_dl_tbtj").remove(),i(".mip_as_djgz").remove(),i(".mip_as_bottm_div").remove()},l=function(t,e,n){var r="";if("COOPERATE_HUASHENG"===t)r="HS";else if("COOPERATE_HUASHENG_QA"===t)r="HSQA";else if("COOPERATE_XINYUHENG"===t)r="XYH";if(""!==r){var o="http://m.iask.sina.com.cn/t/wlsh?openCorporationId="+e+"&type="+r;i.get(o,function(t){var e=i.parseJSON(t);if("Y"===e.succ){var o=i.parseJSON(e.html),s=!0,a="",l="";if("XYH"===r)s=!1,a=c(o.pics[1].picLink,o.pics[1].picLocal);else{var d=o.pics[3]||"";a=c(d.picLink,d.picLocal);var f=o.companyName||"",p=o.drName||"",h=o.website||"",d=o.pics[0]||"";l=u(f,p,h,d.picLocal)}if(i(n).empty(),i(n).append(a),s)if(i(".qs_bar").length>0)i(".qs_bar").eq(0).empty(),i(".qs_bar").eq(0).append(l);else i(".mip_as_other_qiye_div").eq(0).empty(),i(".mip_as_other_qiye_div").eq(0).prev().prev().remove(),i(".mip_as_other_qiye_div").eq(0).append(l)}})}},c=function(t,e){var i="";return i+="<mip-fixed type='bottom' id='customid' >",i+="<div class='mip-adbd'>",i+="<div on='tap:customid.close' class='mip-adbd-close'><span>关闭</span></div>",i+="<a href="+t+" target='_blank'>",i+="<mip-img class='mip-img' src="+e+"></mip-img>",i+="</a>",i+="</div></mip-fixed>"},u=function(t,e,i,n){var r="<div class='firms-con'>";return r+="<div class='firms-pic'>",r+="<mip-img class='mip-img' src="+n+"></mip-img>",r+="<span class='icon-v'></span>",r+="</div>",r+="<div class='firms-text'>",r+="<p><span class='name'>"+t+"</span><span class='time'> 16-09-05</span></p>",r+="<p>"+e+"</p>",r+="</div>",r+="<a href="+i+" target='_blank' class='btn-ask'>咨询专家</a>",r+="</div>",r+="</div>"},d=function(t,e){for(var n="http://m.iask.sina.com.cn/mib/tag/",o=t.split(":"),s=0;s<o.length;s++)n+=o[s];try{var a="",l="";r(function(t){a=t.province,l=t.city}),i.get(n,function(t){var n=i.parseJSON(t);if(console.log(n),"Y"===n.succ){var r=e.split(":"),o=i.parseJSON(n.html),s=parseInt(r[0],0),c=parseInt(r[1],0),u=r[2],d=r[3],h=r[4],m=r[5],g=j(),y=r[6]||"79",v=r[7];if("undefined"!=typeof o){var b=f({mainTags:m,province:a,qCid:y,bCid:v,city:l,lenGood:s,lenother:c,commercialSource:d,qSourceType:u,qTags:h,nowTime:g});p(b,o)}}})}catch(t){}},f=function(t){var e={province:"",lenGood:0,lenother:0,commercialSource:"",qSourceType:""},n=i.extend(e,t);return n},p=function(t,n){if("COMMERCIAL_ZWZD"!==t.commercialSource&&"COOPERATE_SOUTHNETWORK"!==t.qSourceType&&"COOPERATE_XINYUHENG"!==t.qSourceType&&"COOPERATE_HUASHENG"!==t.qSourceType&&"COOPERATE_HUASHENG_QA"!==t.qSourceType)if(!t.city)return void e(t,n);else return void i.each(n,function(e){try{var i=n[e],r=i.qTags,o=i.mainTags,s=i.startTime,a=i.endTime,l="不限",c="不限",u="不限",d="不限";if(i.city)u=i.city;if(i.ncity)d=i.ncity;if(i.province)l=i.province;if(i.nprovince)c=i.nprovince;if("79"===t.qCid||"147"===t.bCid)if(_(t.nowTime,s,a)&&k(t.province,l,c)&&w(t.city,u,d)&&T(t.qTags,r,t.mainTags,o))h(i,t)}catch(t){}})},h=function(t,e){if(void 0!==t)for(var i=t.adPosition,n=i.split(","),r=0;r<n.length;r++)m(n[r],t,e)},m=function(t,e,i){try{if("1"===t)y(e,i);else if("2"===t)v(e,i);else if("3"===t)b(e,i)}catch(t){}},g=function(t,e,n){if(e.lenGood>=t){var r=i(".qs_bar").eq(t-1);r.removeClass(),r.empty(),r.append(n)}else{t=e.lenGood>0?t-1:t;var r=i(".mip_as_other_qiye_div").eq(t-1);r.removeClass(),r.empty(),r.prev().prev().remove(),r.append(n)}},y=function(t,e){g(1,e,u(t.hospitalName,t.contacts,t.url,t.logo))},v=function(t,e){g(2,e,u(t.hospitalName,t.contacts,t.url,t.logo))},b=function(t,e){i(".mip_as_bottm_div").empty(),i(".mip_as_bottm_div").append(c(t.url,t.mSuspensionImage))},_=function(t,e,i){if(e<=t&&t<i)return!0;else return!1},w=function(t,e,i){if(i.indexOf(t)!==-1)return!1;if("不限"===e)return!0;else return e.indexOf(t)!==-1?!0:!1},k=function(t,e,i){if(i.indexOf(t)!==-1&&"不限"!==i)return!1;if("不限"===e)return!0;else return e.indexOf(t)!==-1?!0:!1},T=function(t,e,i,n){if(e)for(var r=e.split(","),o=0;o<r.length;o++)if(t.indexOf(r[o])!==-1)return!0;if(n)for(var r=n.split(","),o=0;o<r.length;o++)if(i.indexOf(r[o])!==-1)return!0;return!1},x=function(t,e){switch(arguments.length){case 1:return parseInt(Math.random()*t+1,0);case 2:return parseInt(Math.random()*(e-t+1)+t,0);default:return 0}},j=function(){var t=new Date,e=t.getMonth()+1,i=t.getDate(),n=t.getHours(),r=t.getMinutes(),o=t.getSeconds();return t.getFullYear()+"-"+(e<10?"0"+e:e)+"-"+(i<10?"0"+i:i)+" "+(n<10?"0"+n:n)+":"+(r<10?"0"+r:r)+":"+(o<10?"0"+o:o)};return n.prototype.build=function(){var t=this.element,e=i(t).attr("div"),n=i(t).attr("area"),r=i(t).attr("len"),c=i(t).attr("type"),u=i(t).attr("sources"),f=i(t).attr("openId"),p=i(t).attr("tags"),h=i(t).attr("params");if(r)s(r,e,c);if(n)o(n,e);if("COMMERCIAL_IAD"===u||"COMMERCIAL_ZWZD"===u||"COMMERCIAL_CAD"===u)a();if("COOPERATE_HUASHENG"===u||"COOPERATE_HUASHENG_QA"===u||"COOPERATE_XINYUHENG"===u)l(u,f,e);if(p)d(p,h)},n}),define("mip-iask-business",["mip-iask-business/mip-iask-business"],function(t){return t}),function(){function t(t,e){t.registerMipElement("mip-iask-business",e)}if(window.MIP)require(["mip-iask-business"],function(e){t(window.MIP,e)});else require(["mip","mip-iask-business"],t)}();