define("mip-ck-course-detail/js/comments",["require","zepto","./mediator","./util","./tpl-data"],function(t){function i(t,i){if(i)o.html(t),s=o.find(".comment"),g=!s.length;else s.append(t)}function e(t,e){var n=p.domain+"/wap/mip/course/comments",o={pn:t,courseId:a,sid:l};if(m>0)o.appraise=m;b=!0,c.ajax({url:n,data:o,dataType:"jsonp",success:function(n,o,s){n=n||{};var r=c.trim(n.html||"");if(r)i(r,e);else g=!0;b=!1,f=t},complete:function(){b=!1}})}function n(){r=d.get("courseInfo"),a=r.courseid,l=r.sid,o=c("#comments_box"),h.on("tab-switched",function(t,i){if(2===i){if(v=!0,!x)e(1,!0)}else v=!1}),h.on("window-scroll",function(t,i){if(!g&&!b&&v){var n=u.height()+u.scrollTop(),s=o.offset().top+o.height();if(s-n<=10)e(f+1)}}),o.on("click",".comment-complete > a",function(){m=parseInt(c(this).attr("appraise"),10),e(1,!0)})}var o,s,r,a,l,c=t("zepto"),h=t("./mediator"),p=t("./util"),d=t("./tpl-data"),u=c(window),f=0,m=0,g=!1,b=!1,v=!1,x=!1;return n});