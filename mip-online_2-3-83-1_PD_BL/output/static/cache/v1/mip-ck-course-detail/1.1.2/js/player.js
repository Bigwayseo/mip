define("mip-ck-course-detail/js/player",["require","zepto","./mediator","./tpl-data","./lib/video","./lib/videojs-contrib-hls"],function(t){function e(){b=f.get("courseInfo"),_=b.courseid,w=b.sid,x=b.cid,T=b.uid,k=b.type,S=f.get("playerInfo"),j=S.hasVideo,E=S.preVideoSrc,P=S.vodSource,C=S.coverUrl}function i(t){v=m("video"),v.src({src:t.src,code:t.key,courseid:_+"",sid:w+"",cid:(t.cid||x)+"",uid:T+"",type:t.src.indexOf(".mp4")>-1?"":"application/x-mpegURL"})}function n(){g=p(".video"),y=p('<video id="video" class="video-js vjs-default-skin link" poster="'+C+'" controls></video>'),g.prepend(y)}function r(){if(P.length>0)i(P[0]);else i({src:E[0],key:""})}function o(){if(1===k)h.trigger("trial-next")}function s(t){if(t<=0)return clearTimeout(O),O=null,p("#play-end").hide(),void o();else return p("#auto_play_num").text(t),void(O=setTimeout(function(){s(t-1)},1e3))}function a(){if(M)h.trigger("toggle-app-download-banner")}function l(){var t=y[0];if(v.currentTime()>=parseInt(v.duration(),10)-1)if(1===k)t.load(),s(3),h.trigger("toggle-end-pop");else if(2===k)t.load(),p("#trial-end").show()}function c(){v.on("pause",a),v.on("ended",l)}function u(){v.off("pause",a),v.off("ended",l),v.dispose()}function d(){if(e(),j)h.on("toggle-app-download-flag",function(t,e){var i=e.show;M=!!i}),h.on("change-video-src",function(t,e){if(v)u();n(),i(e.data),c(),p("#video_loading").remove(),h.trigger("toggle-app-download-banner",!0),M=!0}),p("#play-next-class").on("click",function(){o()}),n(),r(),c()}var p=t("zepto"),h=t("./mediator"),f=t("./tpl-data"),m=t("./lib/video");window.videojs=m;var g,y,v,b,_,w,x,T,k,S,j,E,P,C,O,M=(t("./lib/videojs-contrib-hls"),!0);return d});