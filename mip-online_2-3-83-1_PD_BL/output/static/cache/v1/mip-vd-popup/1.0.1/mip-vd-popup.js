define("mip-vd-popup/mip-vd-popup",["require","zepto","customElement","./tab","./popup"],function(e){function t(e){for(var t=o(this.element),i=parseInt(t.attr("page-size"),10)||v,n=parseInt(t.attr("current"),10)||1,a=parseInt(t.attr("total"),10)||1,r=Math.ceil(a/i),s=Math.floor((n-1)/i),f=[],g=0;g<r;g++){var w=i*g+1,x=Math.min(a,i*(g+1));f.push({from:w,to:x,text:""+w+(w<x?" - "+x:"")})}var y=o('<div class="'+c+'"></div>');if(y.append(f.map(function(t,i){for(var o='<div class="'+d+' mip-vd-tabs-episode-content" '+(i===s?"":'style="display:none;" ')+" >",a=t.from;a<=t.to;a++){var r=a===n?"mip-vd-tabs-episode-item-selected":"",c=e?' href="'+e.replace(b,a)+'"':"";o=o+'<span class="mip-vd-tabs-episode-item '+r+'" '+c+">"+a+"</span>"}return o+="</div>"}).join("")).append(),r>1){var _="",k=4;if(r>k)_='<div class="'+m+'">';if(_+='<ul class="'+u+" "+h+' mip-vd-tabs-episode-bottom-nav">',_+=f.map(function(e,t){var i=t===s?p:"";return'<li class="'+l+" "+i+'">'+e.text+"</li>"}).join(""),_+="</ul>",r>k)_+="</div>";y.append(_)}return y}function i(e,t){var i=this.element,n=o(i),a=parseInt(n.attr("page-size"),10)||v,c=parseInt(n.attr("current"),10)||1,h=parseInt(n.attr("total"),10)||1,b=Math.ceil(h/a);o(e).on("click",function(e){new s({title:i.getAttribute("title")||"",content:t,fullView:!1,customClassName:"mip-vd-popup-custom-modal",onOpen:function(){new r(t,{allowScroll:b>4,current:Math.floor((c-1)/a)||0,currentClass:p,navWrapperClass:u,viewClass:m,contClass:d,navClass:l,logClass:"mip-vd-tabs-log",toggleClass:f})}})})}function n(e){var t=this.element.getAttribute("head-title");e.delegate(".mip-vd-tabs-episode-item","click",function(e){e.preventDefault();var i=o(this).attr("href");if(i){var n=o(this).text()||"",a={event:"loadiframe",data:{url:i,title:t||n}};if(window.parent!==window)window.parent.postMessage(a,"*");else location.href=i}})}var o=e("zepto"),a=e("customElement").create(),r=e("./tab"),s=e("./popup"),c="mip-vd-tabs",d="mip-vd-tabs-content",p="mip-vd-tabs-nav-selected",l="mip-vd-tabs-nav-li",u="mip-vd-tabs-nav",m="mip-vd-tabs-nav-view",f="mip-vd-tabs-nav-toggle",h="mip-vd-tabs-nav-bottom",v=50,b=/\{\{\w}}/g;return a.prototype.build=function(){var e=this.element,a=o(e),r=e.getAttribute("type"),s=e.getAttribute("link-tpl"),c=null,d=null;switch(r){case"episode":c=t.call(this,s),d=a,n.call(this,c);break;default:d=a.children().eq(0),c=a.children().eq(1).addClass("mip-vd-popup-dom")}i.call(this,d,c)},a}),define("mip-vd-popup",["mip-vd-popup/mip-vd-popup"],function(e){return e}),define("mip-vd-popup/tab",[],function(){function e(e,n,o,a,r){var s=0;if(e<n);else if(e>=a-n)s=o.parent().offset().width;else s=o.offset().left-o.parent().offset().left-o.width();if(!i)if(r)t(o.parent().parent().scrollLeft(),s,o.parent().parent());else o.parent().parent().scrollLeft(s)}function t(e,t,n){var o=(t-e)/8;i=setInterval(function(){var e=n.scrollLeft();if(o>0&&e>=t||0==o)o=0,clearInterval(i);else if(o<0&&e<=t)o=0,clearInterval(i);n.scrollLeft(e+o)},30),setTimeout(function(){clearInterval(i),n.scrollLeft(t),i=null},270)}var i,n=function(){},o=function(e){var t=this,i=$(t.panel);this.toggle=i.find("."+t.toggleClass),this.view=i.find("."+t.viewClass),this.wrapper=i.find("."+t.navWrapperClass),this.navs=this.wrapper.find("."+t.navClass),this.conts=i.find("."+t.contClass),this.sum=this.navs.length,this.tabScroll=void 0,c.call(this),this.allowScroll&&this.view.length&&r.call(this),this.toggleMore&&this.allowScroll&&this.view.length&&s.call(this)},a=function(e){var t=this;if(e.children().eq(0).wrap('<div class="mip-vd-tabs-scroll-touch"></div>'),e.children().eq(1).hasClass(t.toggleClass))e.find("."+t.navWrapperClass).append('<div class="mip-vd-tabs-nav-toggle-holder"></div>');return e},r=function(){var t=this;if(t.tabScroll=a.call(t,t.view),t.current>0&&t.current<t.sum){var i=Math.min(t.current+1,t.sum-1);if(t.navs.eq(i).length&&t.navs.eq(i).position().left>t.view.width()-29)e(i,1,t.navs.eq(t.current),t.navs.length,!1)}if("function"==typeof t.onTabScrollEnd)t.tabScroll.on("scrollEnd",function(){if(!this.customFlag||!this.customFlag.autoScroll)t.onTabScrollEnd.call(t,this)})},s=function(){function e(){o.empty(),n.hide(),i.toggle.css({"-webkit-transform":"scaleY(1)",transform:"scaleY(1)"}),i.toggleState=0}function t(){o.html(i.navs.clone()),n.append(o),i.view.after(n.show()),i.toggle.css({"-webkit-transform":"scaleY(1)",transform:"scaleY(-1)"}),i.toggleState=1}var i=this,n=$('<div class="'+i.layerClass+'"><p>'+i.toggleLabel+"</p></div>"),o=$('<ul class="'+i.layerUlClass+'"></ul>');i.toggleState=0,o.on("click","."+i.navClass,function(){var t=$(this);i.navs.eq(t.attr("data-tid")).trigger("click"),e()}),i.toggle.on("click",function(){if(0==i.toggleState)t();else e()})},c=function(){var t=this;$.each(t.navs,function(i,o){var a=$(o);if(a.hasClass(t.currentClass))t.current=i;a.addClass(t.logClass),a.attr("data-tid",i),a.on("click",function(){var i=parseInt($(this).attr("data-tid"));if(i!==t.current){if(t.last=t.current,t.current=i,t.hideTab(t.last),t.showTab(t.current),t.onResetChange==n)t.hideContent(t.last),t.showContent(t.current),t.onChange.call(t,t.current,t.conts[t.current]);else t.onResetChange.call(t,t.current);if(t.tabScroll)e(t.current+1,1,a,t.navs.length,!0)}})}),$.each(t.conts,function(e,i){if(e==t.current)t.showTab(e),t.showContent(e);else t.hideTab(e),t.hideContent(e)})},d=function(e,t){t=t||{},this.panel=e,this.current=t.current||0,this.currentClass=t.currentClass||"c-tabs-nav-selected",this.navWrapperClass=t.navWrapperClass||"c-tabs-nav",this.navClass=t.navClass||"c-tabs-nav-li",this.contClass=t.contClass||"c-tabs-content",this.viewClass=t.viewClass||"c-tabs-nav-view",this.toggleClass=t.toggleClass||"c-tabs-nav-toggle",this.layerClass=t.layerClass||"c-tabs-nav-layer",this.layerUlClass=t.layerUlClass||"c-tabs-nav-layer-ul",this.allowScroll=t.allowScroll||!1,this.toggleMore=t.toggleMore||!1,this.toggleLabel=t.toggleLabel||"请选择",this.logClass=t.logClass||"WA_LOG_TAB",this.scrollSize=t.scrollSize||"-40",this.navs=[],this.seps=[],this.conts=[],this.sum=0,this.last=null,this.onChange=t.onChange||n,this.onResetChange=t.onResetChange||n,this.onTabScrollEnd=t.onTabScrollEnd,e&&o.call(this,t)};return $.extend(d.prototype,{showContent:function(e){var t=this.conts[e];if(t)$(this.conts[e]).show()},hideContent:function(e){var t=this.conts[e];if(t)$(t).hide()},showTab:function(e){var t=this,i=t.navs;t.seps;$(i[e]).addClass(t.currentClass)},hideTab:function(e){var t=this,i=t.navs;t.seps;$(i[e]).removeClass(t.currentClass)}}),d}),define("mip-vd-popup/popup",[],function(){var e=function(e){var t=this;t.options=$.extend({title:"",content:"",fullView:!1,duration:400,customClassName:"",onOpen:function(){},onClose:function(){}},e),t._init()};return e.prototype={constructor:e,version:"0.0.1",_init:function(){var e=this;e._preparePopupWrapper(),e.popup()},_preparePopupWrapper:function(){var e=this,t=$(".mip-vd-popup-wrapper");if(t.length)e.$popupFrame=t,e.$popupFrame.empty();else e.$popupFrame=$('<div class="mip-vd-popup-wrapper"></div>'),$(document.body).append(e.$popupFrame)},_stopScroll:function(){var e=this;e.$popupFrame.on("touchmove",function(e){e.preventDefault()})},_bindEvent:function(){var e=this;e.$popupFrame.on("click",".mip-vd-popup-mask,.mip-vd-popup-remove",function(){e.closePopup()})},_randerContent:function(){var e=this;if(e.$popupMask=$('<div class="mip-vd-popup-mask"></div>'),e.$popupModal=$('<div class="mip-vd-popup-modal"></div>'),e.$popupContent=$('<div class="mip-vd-popup-content"></div>'),e.$popupHead=$('<div class="mip-vd-popup-head"></div>'),e.options.title){var t=$('<div class="mip-vd-popup-title"></div>');t.append(e.options.title),e.$popupHead.append(t)}var i=$('<div class="mip-vd-popup-remove"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqBAMAAAA37dRoAAAAElBMVEUAAABmZmZmZmZmZmZmZmZmZmYlNPltAAAABXRSTlMAnAFiY7dPC10AAACQSURBVCjPfdPdCYAgFIZhsQkKuq8m6KYRGiDK/Vep5MALL2IQfepD/nHSMCU/656Oa1Fnnu80l8m0XN8rnH+XhYMJhwJD+UIJpiQEEeDMOA2GwaI0oWDRwEGFt0qNx0qNS1BhUff6D93ZvLLuLrzj3un4JE2NfUPOYN+8EoIAEcVAwaahghq3q+VsVNbTrsIXTkQ1/j8utO4AAAAASUVORK5CYII="></div>');e.$popupHead.append(i),e.$popupContent.append(e.options.content),e.$popupModal.append(e.$popupHead).append(e.$popupContent).addClass(e.options.customClassName),e.$popupFrame.append(e.$popupModal).append(e.$popupMask)},popup:function(){var e=this,t=$(window).height();e._randerContent(),e._bindEvent(),e.$popupMask.show().animate({opacity:1},"fast","ease"),e.$popupModal.show();var i=e.$popupModal.height();if(e.options.fullView||i>t)e.$popupModal.height("100%");e.$popupModal.animate({"-webkit-transform":"translate3d(0, 0, 0)",transform:"translate3d(0, 0, 0)"},e.options.duration,"ease",function(){$(this).css({"-webkit-transform":"none",transform:"none"}),e.options.onOpen()})},closePopup:function(){var e=this;e.$popupModal.animate({"-webkit-transform":"translate3d(0, 100%, 0)",transform:"translate3d(0, 100%, 0)"},e.options.duration,"ease",function(){$(this).css({"-webkit-transform":"none",transform:"none"}).hide(),e.options.onClose(),e._destroy()}),e.$popupMask.animate({opacity:0},"fast","ease",function(){$(this).hide()})},_destroy:function(){var e=this;e.$popupFrame.off("click",".mip-vd-popup-mask,.mip-vd-popup-remove"),e.$popupFrame.empty()}},e}),function(){function e(e,t){e.registerMipElement("mip-vd-popup",t,".mip-vd-popup-wrapper{z-index:900}.mip-vd-popup-mask{display:none;position:fixed;left:0;top:0;opacity:0;width:100%;height:100%;background:rgba(0,0,0,0.4);z-index:901}.mip-vd-popup-modal{display:none;position:fixed;left:0;bottom:0;width:100%;background-color:#fff;z-index:902;margin:0;overflow:hidden;-webkit-transform:translate3d(0, 100%, 0);transform:translate3d(0, 100%, 0);overflow-y:scroll}.mip-vd-popup-head{text-align:left;padding:0 16px;height:43px;line-height:43px;border-bottom:1px solid #eeeeee}.mip-vd-popup-title{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.mip-vd-popup-remove{position:absolute;padding:15px 16px;right:0;top:0;line-height:14px;z-index:901}.mip-vd-popup-remove img{width:14px;height:14px}.mip-vd-popup-content{text-align:center;margin:0}.mip-vd-popup-dom{display:none}.mip-vd-popup-content .mip-vd-popup-dom{display:block}.mip-vd-popup-modal .mip-vd-tabs-nav-view{height:38px}.mip-vd-tabs{position:relative}.mip-vd-tabs-nav{display:-webkit-box;display:-webkit-flex;height:44px;font-size:14px;white-space:nowrap;background-color:#fff;-webkit-align-content:flex-start;-webkit-align-items:stretch;-webkit-box-align:stretch;-webkit-box-direction:normal;-webkit-box-lines:single;-webkit-box-orient:horizontal;-webkit-box-pack:justify;-webkit-flex-direction:row;-webkit-flex-wrap:nowrap;-webkit-justify-content:space-between;padding:0 16px}.mip-vd-tabs-nav *{-webkit-box-sizing:border-box;box-sizing:border-box}.mip-vd-tabs-nav-li{display:block;overflow:hidden;width:16.66666667%;height:44px;padding:0 14px 0 15px;line-height:44px;text-align:center;white-space:nowrap;text-decoration:none;text-overflow:ellipsis;list-style:none;color:#333;-webkit-box-flex:1;-webkit-flex:1 1 auto}.mip-vd-tabs-nav .mip-vd-tabs-nav-selected{border-bottom:1px solid #38f;color:#38f}.mip-vd-tabs-nav-bottom{border-top:1px solid #eee;background:#f8f8f8}.mip-vd-tabs-nav-bottom .mip-vd-tabs-nav-li{color:#666}.mip-vd-tabs-nav-bottom .mip-vd-tabs-nav-icon{display:none}.mip-vd-tabs-nav-bottom .mip-vd-tabs-nav-li.mip-vd-tabs-nav-selected{position:relative;top:-1px;height:38px;border:1px solid #f1f1f1;border-color:#fff #f1f1f1 #38f #f1f1f1;line-height:38px;color:#333;background-color:#fff}.mip-vd-tabs-nav-bottom .mip-vd-tabs-nav-selected:first-child{margin-left:-1px}.mip-vd-tabs-nav-bottom .mip-vd-tabs-nav-selected .mip-vd-tabs-nav-icon{display:inline-block}.mip-vd-tabs-nav-view{position:relative;overflow:hidden;height:44px;text-align:left;background-color:#fff}.mip-vd-tabs-nav-view .mip-vd-tabs-nav{display:inline-block;position:relative}.mip-vd-tabs-nav-view .mip-vd-tabs-nav .mip-vd-tabs-nav-li{display:inline-block;vertical-align:middle;width:auto;padding:0 15px}.mip-vd-tabs-nav-view .mip-vd-tabs-nav.mip-vd-tabs-nav-bottom{background-color:#f8f8f8;position:relative;display:inline-block;vertical-align:middle}.mip-vd-tabs-nav-layer{position:absolute;z-index:8;top:0;width:100%;border-bottom:1px solid #e7e7e7;background-color:#fff}.mip-vd-tabs-nav-layer p{height:44px;padding:0 16px;border-bottom:1px solid #eee;line-height:44px;text-align:left;color:#333}.mip-vd-tabs-nav-layer-ul .mip-vd-tabs-nav-li{display:inline-block;width:16.66666667%;padding:0}.mip-vd-tabs-nav-layer-ul .mip-vd-tabs-nav-selected{color:#38f}.mip-vd-tabs .mip-vd-tabs-nav-toggle{position:absolute;z-index:9;top:0;right:0;display:block;width:42px;height:26px;margin:9px 0;border-left:1px solid #ccc;text-align:center;background-color:#fff}.mip-vd-tabs .mip-vd-tabs-nav-toggle img{position:absolute;top:50%;left:50%;display:inline-block;width:10px;height:6px;margin:-3px 0 0 -5px}.mip-vd-tabs .mip-vd-tabs-nav-toggle-holder{display:inline-block;width:29px;height:1px;visibility:hidden}.mip-vd-tabs-scroll-touch{position:relative;overflow-x:auto;-webkit-overflow-scrolling:touch;padding-bottom:30px;margin-top:-30px;-webkit-transform:translateY(30px);transform:translateY(30px);width:1px;min-width:100%}.mip-vd-tabs-episode-content{padding:15px 16px;text-align:left}.mip-vd-tabs-episode-item{display:inline-block;width:20%;height:40px;line-height:40px;text-align:center}.mip-vd-tabs-episode-item-selected{color:#38f}.mip-vd-tabs-episode-bottom-nav{padding:0;height:38px}.mip-vd-tabs-episode-bottom-nav .mip-vd-tabs-nav-li{height:38px;line-height:38px}.mip-vd-tabs-nav-view>.mip-vd-tabs-scroll-touch>.mip-vd-tabs-episode-bottom-nav.mip-vd-tabs-nav>.mip-vd-tabs-nav-li{display:inline-block}.mip-vd-tabs-episode-bottom-nav.mip-vd-tabs-nav .mip-vd-tabs-nav-li{display:block}.mip-vd-tabs-row-tile{width:100%;position:relative;overflow:hidden}")}if(window.MIP)require(["mip-vd-popup"],function(t){e(window.MIP,t)});else require(["mip","mip-vd-popup"],e)}();