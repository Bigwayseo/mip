# Mobile Instant Pages - 移动网页加速器

> 20170424 - 20170428

> FE成员: 李浪波、孟珂、吴鹏、王培、传涛、梁佳莹、亢明悦

## 目录

- [一、MIP 核心代码](#mip)
- [二、MIP 组件](#extensions)
- [三、MIP 官网](#website)
- [四、MIP 博客](#blogs)
- [五、AMP 翻译](#blogs)
- [六、MIP 工具](#tools)
- [七、MIP 落地](#impl)
- [八、TODO](#todo)
- [九、已上线](#online)

## <span id="mip">一、MIP 核心代码</span>

统一管理资源的加载，并支持 MIP 标签的使用，从而确保页面的快速渲染，提高页面各方面的性能。对一些问题进行统一处理，封装了内置工具 API 供组件开发使用。

### 1. gesture(@吴鹏)

#### 背景与目标

```
升级gesture模板，实现多点触摸
```

#### 本周进展

- 状态：hold

### 2. MIP Cache Cookie(@吴鹏)

#### 背景与目标

```
目前线上由于广告商和三方站长设置cookie，导致请求中如果cookie过大会出现请求bad request，开发了cookie限定功能，以避免这种情况；
```

#### 本周进展

- 依赖：二级域名，4月中旬启动开发

### 3. MIP Service Worker落地
```
为了让mip页面能够享用离线访问的效果，加入server worker来进行支持；
```

- 状态
    - 兆明跟进；

### 4. tap事件支持点击触发(@佳莹)

#### 背景与目标

```
目前mip.js提供的tap手势仅支持touch事件，在pc上不可用。需要兼容click触发
```

#### 本周进展

- 4.28 开发中

### 5. TODO

- [未启动] MIP DOM 化
- [调研中] A4A


## <span id="extensions">二、MIP 组件</span>

### 1. mip-access(@吴鹏)

#### 背景与目标

    ACCESS能够允许发布者对页面内容进行访问权限的控制，通过内容标记和用户访问情况进行综合评价，从而实现对付费墙和订阅功能的支持。

#### 完成情况

- 进度：
    - 2.24产出登录方案；
    - 2.24登录功能开发完成；
    - 3.9完成对外展示DEMO，已上线；
    - 3.28确认域名申请信息，目前进行中；
- 依赖：cookie

### 2. mip-bind（@王培）

#### 背景与目标

   实现数据驱动组件

##### 完成情况

- 进度：调研中

### 3. mip-stats-baidu（@langbo）

#### 背景与目标

   支持mip path 能够正常传 eqid

##### 完成情况

- 进度： 4月24日上线完成，结题

### 4. mip-gototop mip-form mip-carousel（@明悦）

#### 背景与目标

   支持click

##### 完成情况

- 进度： 开发中

### 5. mip-carousel（@明悦）

#### 背景与目标

修改轮播组件支持mip-link

##### 完成情况

- 进度： 开发中

### TODO

#### 1. 点赞、阅读

- 背景：实现用户页面点在功能，以及记录阅读数功能
- 状态：hold

#### 2. mip-recommend 推荐组件

- 背景：根据用户行为想用户推荐内容
- 状态：hold

### 组件BUG修复

#### 1. mip-video 视频组件安卓播放BUG（@传梼）

- 原因：video播放时，浏览器调起native播放器，导致在iframe下视频窗口漂浮BUG
- 进度：[已定位]，域名问题，需要浏览器添加白名单（后续@浪波跟进）

#### 2. UC 屏蔽 mip.js（@浪波）

- 原因：UC 屏蔽 mip.js，导致mip页面加载失败
- 进度：UC 屏蔽了广告 js，目前 cache 已经上线一版策略，将 ad 的 js 文件名进行随机更改

#### 3. mip-video 视频组件source支持与播放按钮（@传梼）

- 原因：现mip-video不支持source情况，需要升级。
- 进度：待上线
- 上线依赖: 依赖验校


### 第三方组件开发情况

#### 完成情况

- [mip-extension 审核中](https://github.com/mipengine/mip-extensions) PR 3 个

-  本周新增组件 4 个

-  组件平台新增 3 个

- 站长[历史组件 136 个](#widget-ed)

## <span id="beautymip">三、MIP 定制化</span>

### 背景与目标

    定制化 MIP 能够给 MIP 页面赋能，使其页面能够直接使用百度的优质服务，比如广告、推荐等

### 本周进展
- 工具集合
    - 完成了定制化工具静态资源编译功能；
    - 完成了工具单测；
    - 完成了工具持续集成；
    - 将mip-cli, mip-processor, mip-cli-bolier, mip-cli-boilerplate发布至npm；
- 通用组件 mip-custom 的开发
    - 完成了工具对组件添加、校验的升级；
    - 完成了工具的线上线下调试、预览等功能；
    - 数据格式制定（已完成）
    - 组件获取 xpath(已完成)
    - 公共css提取（已完成）
    - 支持结果分组（已完成）
- 日志方案已敲定  http://gitlab.baidu.com/MIP/mip-customization/wikis/%E6%97%A5%E5%BF%97
- mip 结果页逻辑，阿拉丁逻辑开发完成，mip service 开发完成，核心代码的隐藏唤醒逻辑已开发完成，5月3日上线

### TODO

-  制定一系列规范，以及落地

## <span id="website">四、MIP 官网</span> (@佳莹)

- 官网地址：https://www.mipengine.org/

### 背景与目标

    MIP 官方网站，提供了完整的 MIP 规范，组件文档，开发教程等；现在处于v2.0稳定阶段

### 本周进展

4.28 本周无进展

### TODO

- 增加周报内容

## <span id="blogs">五、MIP 博客</span>(@佳莹，@明悦)

- 博客地址：http://www.cnblogs.com/mipengine/

### 背景与目标

    对用户、开发者在使用和改造过中遇到的一系列问题的整理，同时对 MIP 每次重大更新的说明文章

### 本周进展

- 4.28 本周无进展

## <span id="blogs">五、AMP 翻译</span> (@浪波、@吴鹏、@王培、@佳莹、@明悦、@俊杰)

- 内网地址：http://gitlab.baidu.com/MIP/amp-blog

### 背景与目标

    汉化AMP文档，为AMP贡献中文资源。
    每周每人一篇，周五值周人分任务，周五12:00前交作业

### 本周进展

原文URL|翻译负责人|翻译进度|gitlab url|reviewer1|r1进度|reviewer2|r2进度| merge进度 | 发布
----|----|----|----|----|----|----|----|----|----|----
[20170228](https://amphtml.wordpress.com/2017/02/28/new-industry-benchmarks-for-mobile-page-speed/)|明悦|已完成|[url](http://gitlab.baidu.com/MIP/amp-blog/blob/master/20170228_%E7%A7%BB%E5%8A%A8%E9%A1%B5%E9%9D%A2%E9%80%9F%E5%BA%A6%E7%9A%84%E6%96%B0%E8%A1%8C%E4%B8%9A%E5%9F%BA%E5%87%86.md)|佳莹|已完成|吴鹏|--|--|--
[20170227](https://amphtml.wordpress.com/2017/02/27/grow-your-business-with-ads-on-amp/)|佳莹|已完成|[url](http://gitlab.baidu.com/MIP/amp-blog/blob/master/20170227_%E5%90%91AMP%E9%A1%B5%E9%9D%A2%E6%8A%95%E6%94%BE%E5%B9%BF%E5%91%8A.md)|吴鹏|--|明悦|--|--|--
[20170112](https://amphtml.wordpress.com/2017/01/12/introducing-accelerated-mobile-links-making-the-mobile-web-app-quick/)|吴鹏|已完成|[url](http://gitlab.baidu.com/MIP/amp-blog/blob/master/20170330_%E9%80%9A%E8%BF%87%E7%A7%BB%E5%8A%A8%E5%8A%A0%E9%80%9F%E9%93%BE%E6%8E%A5%E5%88%B6%E4%BD%9C%E4%B8%8EAPP%E5%90%8C%E6%A0%B7%E5%BF%AB%E9%80%9F%E7%9A%84web%E9%A1%B5%E9%9D%A2.md)|王培|--|浪波|--|--|--
[20170111](https://amphtml.wordpress.com/2017/01/11/google-amp-cache-amp-lite-and-the-need-for-speed/)|浪波|已分配|--|明悦|--|王培|--|--|--
[20161031](https://amphtml.wordpress.com/2016/10/31/forms-now-supported-in-amp/)|王培|已完成|[url](http://gitlab.baidu.com/MIP/amp-blog/blob/master/20161031_AMP%E6%94%AF%E6%8C%81%E8%A1%A8%E5%8D%95%E5%8A%9F%E8%83%BD%E4%BA%86.md)|浪波|--|佳莹|已完成|--|--

## <span id="tools">六、MIP 工具</span>

### 1. MIP 校验工具

#### 背景与目标

> 为了保证所有的 MIP 页面都是符合 MIP 规范的，MIP 团队开发了 MIP 校验工具，方便对 MIP 页面进行校验，同时后端 Spider 校验保证了所有收录的页面都是符合规范的 MIP 页面。

#### 本周进展

#### 3月份校验升级需求梳理

##### 1. mip-video 支持 source 标签（@王培，@杨珺）

- 优先级：高
- 背 景：这种情况下，不需要mip-video的src属性，但是不写src会报错
- 解决方案：增加子节点标识，如果有source子节点则可以没有src属性，需要内部升级
- 状态：前端已发布，spider 校验中

#### TODO

- Spider 校验解决 domparser 问题

### 2. 组件平台

#### 背景与目标

> 1. MIP 组件平台是提供给所有 MIP 开发者开发组件的一个平台，开发者可以在组件平台上提交自己开发的组件，组件通过审核之后能够自动上线。
> 2. 短线方案：部署一台内网环境的机器，开通外网权限，BAE 给此机器一个接口，使此机器能够定时访问此接口，确认是否有组件需要上线，如果需要上线，则自动拉取 github 代码库代码，并且通过 mis 配送上线
> 3. 在平台审核组件的过程中遇到一些用户体验问题，如不能查看代码diff，代码审核之后无法撤销，无法注销账户，打回组件时反馈信息输入框过小等

#### 本周进展

- 状态：已上线

#### TODO

- 组件自动上线长线方案：内网机器配置域名，则组件平台的 BAE 机器可以主动推送组件上线


## <span id="blogs">3. MIP 组件预览平台</span>(@佳莹，@明悦)

### 背景与目标

> 为MIP开发者提供MIP组件可视平台，作为MIP官网文档的补充说明。
> 开发者可以在平台直接预览组件使用效果，并可进行点击交互。平台提供代码修改功能，修改后的MIP页代码会实时同步在预览框中。

### 本周进展

- 开发中。前端demo已产出
- 4.28 开发中。升级mip.js及各个组件，支持click事件

## <span id="impl">七、MIP 落地</span>

和搜索结合相关，项目相关

### 1. MIP cache相关

#### 背景与目标

    页面缓存系统，实现移动网页加速

#### 本周进展

- 反屏蔽广告的改写排期定在1月份第二周【未发现屏蔽现象 hold】

- todolist:http://wiki.baidu.com/display/EnhancedYuqu/mipcache+todolist

- 增加校验功能，春节前上线

- mip-link 改写功能

### 2. MIP 组件接 AE 上线（@王培）

#### 背景与目标

    mis 上线无法备份数据，容错性差

#### 本周进展（delay）

- 依赖 AE 实现增量上线已完成
- 上线切换delay，高优支持定制化 MIP

### 4. 大站运营进展

- 新浪：技术已完成，产品那边刚确认策略，跟着即将上线的一个产品上，时间可能在三月底

- 知乎：PM正在接洽商谈重启 MIP 开发事宜

## 附：第三方组件开发情况

### <span id="widget-ing">审核中：21个</span>

### 5. AMP融合

1、  amp 在百度网页库的量级分析：已完成
2、  mip cache 支持 amp 校验方案已完成 NODE 版本支持，长线提升校验速度的 c++ 版本暂无计划
3、  amp 静态文件的上线通路已打通，能够正常上线
4、  目前百度搜索结果有小部分结果已经是有 AMP 标记，大概有100+左右
5、  MIP 和 AMP 功能互转的成本已经可用性在评估中  4月初
6、  MIP 扩展 AMP功能，实现功能打平，目前已经完成50%的排期计划，出于正在开发阶段，另50%的功能梳理，将在3月24日产出
7、  AMP相关文章汉化版进入 MIP 官网计划正在规划中，进行中
8、  amp 结果 spider 自动识别机制目前无进展
9、  MIP 的功能扩展进入 AMP 组件库梳理计划中


#### TODO

详见wiki：[传送门](http://wiki.baidu.com/pages/viewpage.action?pageId=249763355)

### 2. aladdin MIP机制打通（HOLD）

#### 背景与目标

    在引入阿拉丁资源中，有部分的外跳链接是 MIP 化的页面，可以使用 MIP 页在结果页打开的方式。例如目前线上 query:"奥运” 的阿拉丁结果（并非自动打标，而是硬编码到数据中）
    MIP 页有严格的规范，可以参照上面的 MIP 介绍，需要进行严格的打标记、屏蔽、退化等方式保证线上的良好用户体验

#### 进展

1. 明确建库后续优化计划，采用回写的方式
2. 屏蔽机制确认在 cache 产生词表，具体如何用已经给 US 提需求

## <span id="todo">八、TODO</span>

### A4A 调研

#### 背景与目标

    A4A AMP Ads For AMP Pages，现状：Classical html+js:iframe
    存在问题：UX 损害、加载速度、degrade scrolling,swiping in the carousel,etc.
    提倡：保留iframe，广告页面用mip实现，加快广告请求，只是渲染延迟。如果广告页面是mip规范，可以直接插入 mip 页面中

#### 进展

- 调研中

## <span id="online">九、已上线</span>

- title 机制：sf-mip的 sf 头部区域展示站点中文名
- 枫华和组件平台上线通道打通：为枫化和组件平台打通新的上线通道

序号|PR 名
---|---
566|新加科室id
564|记录修改状态
561|修改百度统计readme
560|修改百度统计
558|去除换成字符串
557|更新组件
536|增加参数
530|起点下拉加载
528|test
524|Mip-link增加前进后退功能
459|广告 BUG 修复
424|mip-ruizhiqi-script
413|update 添加数据统计功能
411|铁血cookie写入
355|修复全网推荐多个广告位加载多次js问题

### <span id="widget-ed">站长历史组件：136个</span>

组件名|功能
---|---
mip-qqtngx-shrinknav|腾牛个性页面的伸缩导航
mip-233-tongji|添加cnzz统计
mip-zpm-company|公司业务需求
mip-custom|mip-xzw-fortune 定制化 MIP 通用组件
mip-wkfun-newslist|寻医问药页面功能组件--站内搜索功能效果
mip-em-hq|自有业务详情页整体交互组件
mip-pcsoft-slide|点击按钮，对应的部分，以上的内容给隐藏掉
mip-pcsoft-form|判断手机系统，搜索关键词后，跳转对应的下载页面
mip-wkfun-change-style|寻医问药页面功能组件
mip-stats-qiyu|网易七鱼在线客服组件
mip-pcsoft-paging|新增pcsoft分页组件
mip-gudindgufeng|gufengmh.com站点投放汇米广告固定位广告插件
mip-gudingwzshipin|用于wzshipin.com站点投放汇米广告固定位广告的组件
mip-game4399-download|mip-game4399-download 实现了简单的游戏下载控件
mip-fh-async|用来支持整站全网异步接口渲染组件
mip-99down-comment|99down下载站文章详情页的评论
mip-99down-dropload|支持页面下拉加载
mip-huayi-kst|华怡MIP站点幻灯片、快商通
mip-fh-ad-plus|支持整站页面的直投广告显示
mip-wangxia-topc|移动跳转PC
mip-zixun|根据关键词加载商务通咨询邀请框
mip-semi-fixed|滑动悬浮组件
mip-qbb-comment|qbb评论组件
mip-qbb-resetpit|根据图片尺寸设置展现宽高
mip-experiment|A/B 对照实验组件
mip-infinitescroll|无限滚动组件
mip-qbb-comment|qbb评论组件
mip-qbb-resetpit| 根据图片尺寸设置展现宽高
mip-ticket| 适用于票价的选择、票数的增加和减少
mip-qqtn-count|站内个人统计功能
mip-showmore | 查看更多组件
mip-dfads|汇米第三方广告
mip-qbb-qinxin|第三方自用
mip-qbb-base64 | 转码组件
mip-qbb-isweixin | 提示微信跳转浏览下载
mip-huimee| 汇米广告组件
mip-app-banner| 调起app组件
mip-39alimama| 39开发阿里妈妈广告组件
mip-askvip-ad| 120ask广告组件
mip-sina-rem| 新浪样式组件
mip-sina-sudalog| 新浪日志统计组件
mip-sina-sudamap| 新浪页面信息&点击统计组件
mip-sina-sax| 新浪广告组件
mip-list|通用列表组件
mip-baiyun-map|baiyun地图组件
mip-discuz-login|论坛登录
mip-discuz-post|论坛发帖
mip-fh-ad-plus|飞华直投广告
mip-analytics|提供统计发送接口
mip-mustache|通用模板组件
mip-fengxi-sdk|凤悉sdk插件
mip-content-readmore|文字截断，查看更多组件
mip-nine-business|页面公共业务逻辑
mip-nine-download|页面下载业务
mip-mz-addonapp| 木子推荐app下载
mip-mz-appdownload|木子 app下载
mip-adsense|google 广告组件
mip-yxdown-floatad|第三方广告投放插件
mip-weiyoubaba-tthead| 微友巴巴头条
mip-cr173-ppzs| 西西软件园皮皮助手下载
mip-3727-pagination |3727图片模拟分页
mip-cr173-count|西西软件园编辑人员统计组件
mip-wkfun-medicine|寻医问药药品频道
mip-wkfun-diseasse|寻医问药疾病频道
mip-bsml-carousel| bsml轮播组件
mip-bsml-fixedbar|bsml底部转换工具组件
mip-bsml-form| bsml表单组件
mip-bsml-multiselect|bsml多选下拉组件
mip-bsml-sliding| bsml图片滑屏组件
mip-bsml-widget|bsml通用组件，包括打点等功能
mip-wangxia-call|自由业务
mip-wangxia-down|下载站定制高速下载组件
mip-cr173-tags|西西软件园适配下载地址组件
mip-news-iframe-interface|资讯下iframe双向通信接口
mip-xzw-article|星座屋mip改造插件
mip-ck-browser|根据不同浏览器展示不同的内容
mip-ck-location|根据不同地区展示不同的内容
mip-xem-buttons|自用buttons组件
mip-xem-dropdowns|自用dropdowns组件
mip-a5-loadmore| a5创业网逻辑组件
mip-haixue-contact|  支持嗨学网咨询功能
mip-haixue-register |支持嗨学网手机注册功能
mip-fh-bus | 改造两性详情页面的脚本代码
mip-ad-random|广告位随机
mip-yxdown-shielding-page|屏蔽问题页面
mip-iask-ajax| iask—ajax请求
mip-iask-business| 爱问商业广告组件
mip-iask-ext| 爱问详细页插件
mip-iask-report| 爱问举报组件
mip-html-ajax| 评论提交加载
mip-down-ppzs|皮皮助手
mip-xem-review| 自用获取随机评论组件
mip-muzi-appdownload| 木子app下载
mip-html-tabs| TAB滑动、显示、隐藏、元素跳转等操作
mip-ls-pagination| 招聘信息列表的分页功能
mip-xem-comment-duoshuo| 多说评论框通用代码稳定版组件
mip-wkfun-club| 寻医问药页面功能组件，提供了一些dom操作功能
mip-news-recommend| 百度资讯垂类新闻和热点推荐组件
mip-huajun-downtag| 点击切换组件
mip-huajun-fixdnav| 固定nav组件
mip-huajun-loadmore| 点击加载更多组件
mip-dad-appdownload| 皮皮高速下载
mip-youth-tb360| 青网移动适配页头部360广告
mip-youth-ttyd| 青网移动适配页精彩推荐广告
mip-global-script| 页面逻辑公共脚本
mip-down-dropload| 用来支持页面下拉加载
mip-down-script| 页面逻辑脚本集合
mip-ecms| 帝国cms,整合包主要包括ecms中调用的js如点赞,阅读量,评论等
mip-changyan| 支持在线评论插件 畅言
mip-xueyou-list| 学优网list组件
mip-xueyou-ad| 学优网广告
mip-xueyou-article| 学优网文章阅读组件
mip-ajax-data| 游侠网用来触发元素ajax异步加载数据到指定容器
mip-yiqibazi-tap |点击切换组件
mip-hk-call| 好看调起客户端
mip-hk-fcvideo| 好看视频组件
mip-hk-showarticle |显示文章更多详情
mip-hk-feed| 好看feed流
mip-hk-keep |好看详情页下载app安装打开对应详情页接口
mip-hk-share |好看分享插件
mip-html-tabs |TAB滑动、显示、隐藏、元素跳转等操作
mip-wkfun |寻医问药页面功能组件
mip-stats-ajk| 安居客统计组件
mip-360doc-script| 360doc网业务逻辑组件
mip-gudindgufeng|gufengmh.com站点投放汇米广告固定位广告插件
mip-fh-async|用来支持整站全网异步接口渲染组件
mip-99down-comment|99down下载站文章详情页的评论
mip-99down-dropload|支持页面下拉加载
mip-huayi-kst|华怡MIP站点幻灯片、快商通
mip-fh-ad-plus|支持整站页面的直投广告显示
mip-wangxia-topc|移动跳转PC
mip-zixun|根据关键词加载商务通咨询邀请框
mip-cr173-addrecomd|添加推荐板块
mip-qqtnhealth-dynamicmenu|页面特效
mip-wkfun-appdown|寻医问药页下载提示条功能效果
mip-cr173-eject|点击下载按钮弹出推荐内容
